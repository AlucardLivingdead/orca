<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <title>Coverage Report - orca.gnomespeechfactory</title>
  <link title="Style" type="text/css" rel="stylesheet" href="trace2html.css"/>
  <script type="text/javascript" src="sortabletable.js"></script>
</head>

<body>
<h1>Coverage Report - orca.gnomespeechfactory</h1>

<table id="summary" class="summary">
<thead>
  <tr><td>Module</td><td>Coverage %</td></tr>
</thead>
<tbody>
<tr class=even>
  <td class="moduleName">
    <a href="orca.gnomespeechfactory.html">orca.gnomespeechfactory</a></td>
  <td class="percent">
    <div class="coveragePercent">
      22%
    </div>
    <div class="coverageBar">
      <div class="inCoverageBar" style="width: 22%">
      </div>
    </div>
  </td>
</tr>

</tbody>
</table>
<script type="text/javascript">
var packageTable = new SortableTable(document.getElementById("summary"),
    ["String", "Percentage"]);
packageTable.sort(0);
</script>


<table class="srcCode">
<tbody>
<tr class="">
  <td class="nbLine">1</td>
  <td class="nbHits"></td>
  <td class="src"><pre># Orca</pre></td>
</tr>
<tr class="">
  <td class="nbLine">2</td>
  <td class="nbHits"></td>
  <td class="src"><pre>#</pre></td>
</tr>
<tr class="">
  <td class="nbLine">3</td>
  <td class="nbHits"></td>
  <td class="src"><pre># Copyright 2005-2007 Sun Microsystems Inc.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">4</td>
  <td class="nbHits"></td>
  <td class="src"><pre>#</pre></td>
</tr>
<tr class="">
  <td class="nbLine">5</td>
  <td class="nbHits"></td>
  <td class="src"><pre># This library is free software; you can redistribute it and/or</pre></td>
</tr>
<tr class="">
  <td class="nbLine">6</td>
  <td class="nbHits"></td>
  <td class="src"><pre># modify it under the terms of the GNU Library General Public</pre></td>
</tr>
<tr class="">
  <td class="nbLine">7</td>
  <td class="nbHits"></td>
  <td class="src"><pre># License as published by the Free Software Foundation; either</pre></td>
</tr>
<tr class="">
  <td class="nbLine">8</td>
  <td class="nbHits"></td>
  <td class="src"><pre># version 2 of the License, or (at your option) any later version.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">9</td>
  <td class="nbHits"></td>
  <td class="src"><pre>#</pre></td>
</tr>
<tr class="">
  <td class="nbLine">10</td>
  <td class="nbHits"></td>
  <td class="src"><pre># This library is distributed in the hope that it will be useful,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">11</td>
  <td class="nbHits"></td>
  <td class="src"><pre># but WITHOUT ANY WARRANTY; without even the implied warranty of</pre></td>
</tr>
<tr class="">
  <td class="nbLine">12</td>
  <td class="nbHits"></td>
  <td class="src"><pre># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</pre></td>
</tr>
<tr class="">
  <td class="nbLine">13</td>
  <td class="nbHits"></td>
  <td class="src"><pre># Library General Public License for more details.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">14</td>
  <td class="nbHits"></td>
  <td class="src"><pre>#</pre></td>
</tr>
<tr class="">
  <td class="nbLine">15</td>
  <td class="nbHits"></td>
  <td class="src"><pre># You should have received a copy of the GNU Library General Public</pre></td>
</tr>
<tr class="">
  <td class="nbLine">16</td>
  <td class="nbHits"></td>
  <td class="src"><pre># License along with this library; if not, write to the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">17</td>
  <td class="nbHits"></td>
  <td class="src"><pre># Free Software Foundation, Inc., 59 Temple Place - Suite 330,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">18</td>
  <td class="nbHits"></td>
  <td class="src"><pre># Boston, MA 02111-1307, USA.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">19</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">20</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>"""Provides a SpeechServer factory for gnome-speech drivers."""</pre></td>
</tr>
<tr class="">
  <td class="nbLine">21</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">22</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>__id__        = "$Id: gnomespeechfactory.py 2126 2007-03-06 21:35:17Z richb $"</pre></td>
</tr>
<tr class="">
  <td class="nbLine">23</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>__version__   = "$Revision: 2126 $"</pre></td>
</tr>
<tr class="">
  <td class="nbLine">24</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>__date__      = "$Date: 2007-03-06 13:35:17 -0800 (Tue, 06 Mar 2007) $"</pre></td>
</tr>
<tr class="">
  <td class="nbLine">25</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>__copyright__ = "Copyright (c) 2005-2006 Sun Microsystems Inc."</pre></td>
</tr>
<tr class="">
  <td class="nbLine">26</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>__license__   = "LGPL"</pre></td>
</tr>
<tr class="">
  <td class="nbLine">27</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">28</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import logging</pre></td>
</tr>
<tr class="">
  <td class="nbLine">29</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>log = logging.getLogger("speech")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">30</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">31</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import os</pre></td>
</tr>
<tr class="">
  <td class="nbLine">32</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">33</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import gobject</pre></td>
</tr>
<tr class="">
  <td class="nbLine">34</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import Queue</pre></td>
</tr>
<tr class="">
  <td class="nbLine">35</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import string</pre></td>
</tr>
<tr class="">
  <td class="nbLine">36</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import threading</pre></td>
</tr>
<tr class="">
  <td class="nbLine">37</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import time</pre></td>
</tr>
<tr class="">
  <td class="nbLine">38</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">39</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import bonobo</pre></td>
</tr>
<tr class="">
  <td class="nbLine">40</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">41</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import atspi</pre></td>
</tr>
<tr class="">
  <td class="nbLine">42</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import chnames</pre></td>
</tr>
<tr class="">
  <td class="nbLine">43</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import debug</pre></td>
</tr>
<tr class="">
  <td class="nbLine">44</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import orca_state</pre></td>
</tr>
<tr class="">
  <td class="nbLine">45</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import punctuation_settings</pre></td>
</tr>
<tr class="">
  <td class="nbLine">46</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import settings</pre></td>
</tr>
<tr class="">
  <td class="nbLine">47</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import speech</pre></td>
</tr>
<tr class="">
  <td class="nbLine">48</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import speechserver</pre></td>
</tr>
<tr class="">
  <td class="nbLine">49</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">50</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>from acss import ACSS</pre></td>
</tr>
<tr class="">
  <td class="nbLine">51</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">52</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>from orca_i18n import _           # for gettext support</pre></td>
</tr>
<tr class="">
  <td class="nbLine">53</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">54</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>atspi.ORBit.load_typelib('GNOME_Speech')</pre></td>
</tr>
<tr class="">
  <td class="nbLine">55</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import GNOME.Speech, GNOME__POA.Speech</pre></td>
</tr>
<tr class="">
  <td class="nbLine">56</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">57</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>class _SayAll:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">58</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def __init__(self, iterator, context, id, progressCallback):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">59</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        self.utteranceIterator   = iterator</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">60</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        self.currentContext      = context</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">61</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        self.idForCurrentContext = id</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">62</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        self.progressCallback    = progressCallback</pre></td>
</tr>
<tr class="">
  <td class="nbLine">63</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">64</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>class _Speaker(GNOME__POA.Speech.SpeechCallback):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">65</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    """Implements gnome-speech's SpeechCallback class.  The gnome-speech</pre></td>
</tr>
<tr class="">
  <td class="nbLine">66</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    server only allows one speech callback to be registered with a speaker</pre></td>
</tr>
<tr class="">
  <td class="nbLine">67</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    and there's no way to unregister it.  So...we need to handle stuff</pre></td>
</tr>
<tr class="">
  <td class="nbLine">68</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    like that on our own.  This class handles this for us and also delegates</pre></td>
</tr>
<tr class="">
  <td class="nbLine">69</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    all calls to the 'real' gnome speech speaker.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">70</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">71</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">72</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def __init__(self, gnome_speaker):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">73</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        self.gnome_speaker = gnome_speaker</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">74</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if settings.enableSpeechCallbacks:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">75</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            gnome_speaker.registerSpeechCallback(self._this())</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">76</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        self.__callbacks = []</pre></td>
</tr>
<tr class="">
  <td class="nbLine">77</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">78</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def registerCallback(self, callback):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">79</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        self.__callbacks.append(callback)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">80</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">81</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def deregisterCallback(self, callback):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">82</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        self.__callbacks.remove(callback)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">83</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">84</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def notify(self, type, id, offset):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">85</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Called by GNOME Speech when the GNOME Speech driver generates</pre></td>
</tr>
<tr class="">
  <td class="nbLine">86</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        a callback.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">87</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">88</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">89</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - type:   one of GNOME.Speech.speech_callback_speech_started,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">90</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                         GNOME.Speech.speech_callback_speech_progress,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">91</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                         GNOME.Speech.speech_callback_speech_ended</pre></td>
</tr>
<tr class="">
  <td class="nbLine">92</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - id:     the id of the utterance (returned by say)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">93</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - offset: the character offset into the utterance (for progress)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">94</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">95</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        for callback in self.__callbacks:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">96</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            callback.notify(type, id, offset)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">97</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">98</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def say(self, text):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">99</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        return self.gnome_speaker.say(text)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">100</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">101</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def stop(self):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">102</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        self.gnome_speaker.stop()</pre></td>
</tr>
<tr class="">
  <td class="nbLine">103</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">104</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def getSupportedParameters(self):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">105</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        return self.gnome_speaker.getSupportedParameters()</pre></td>
</tr>
<tr class="">
  <td class="nbLine">106</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">107</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def getParameterValue(self, name):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">108</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        return self.gnome_speaker.getParameterValue(name)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">109</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">110</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def setParameterValue(self, name, value):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">111</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        return self.gnome_speaker.setParameterValue(name, value)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">112</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">113</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def unref(self):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">114</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        try:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">115</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.gnome_speaker.unref()</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">116</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        except:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">117</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            pass</pre></td>
</tr>
<tr class="">
  <td class="nbLine">118</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">119</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>class SpeechServer(speechserver.SpeechServer):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">120</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    """Provides SpeechServer implementation for gnome-speech."""</pre></td>
</tr>
<tr class="">
  <td class="nbLine">121</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">122</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    # Dictionary of known running servers.  The key is the iid and the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">123</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    # value is the SpeechServer instance.  We do this to enforce a</pre></td>
</tr>
<tr class="">
  <td class="nbLine">124</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    # singleton instance of any given server.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">125</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">126</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    __activeServers = {}</pre></td>
</tr>
<tr class="">
  <td class="nbLine">127</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">128</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def __activateDriver(iid):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">129</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>        driver = bonobo.activation.activate_from_id(iid,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">130</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>                                                    0,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">131</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>                                                    False)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">132</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>        driver = driver._narrow(GNOME.Speech.SynthesisDriver)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">133</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>        isInitialized = driver.isInitialized()</pre></td>
</tr>
<tr class="">
  <td class="nbLine">134</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>        if not isInitialized:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">135</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>            isInitialized = driver.driverInit()</pre></td>
</tr>
<tr class="">
  <td class="nbLine">136</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>        if not isInitialized:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">137</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>            try:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">138</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>                driver.unref()</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">139</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            except:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">140</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                pass</pre></td>
</tr>
<tr class="">
  <td class="nbLine">141</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>            driver = None</pre></td>
</tr>
<tr class="">
  <td class="nbLine">142</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>        return driver</pre></td>
</tr>
<tr class="">
  <td class="nbLine">143</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">144</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    __activateDriver = staticmethod(__activateDriver)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">145</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">146</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def __createServer(iid):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">147</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>        server = None</pre></td>
</tr>
<tr class="">
  <td class="nbLine">148</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">149</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>        if SpeechServer.__activeServers.has_key(iid):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">150</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            server = SpeechServer.__activeServers[iid]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">151</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        else:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">152</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>            driver = SpeechServer.__activateDriver(iid)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">153</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>            if driver:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">154</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>                server = SpeechServer(driver, iid)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">155</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>                SpeechServer.__activeServers[iid] = server</pre></td>
</tr>
<tr class="">
  <td class="nbLine">156</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">157</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>        return server</pre></td>
</tr>
<tr class="">
  <td class="nbLine">158</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">159</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    __createServer = staticmethod(__createServer)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">160</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">161</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def getFactoryName():</pre></td>
</tr>
<tr class="">
  <td class="nbLine">162</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Returns a localized name describing this factory."""</pre></td>
</tr>
<tr class="">
  <td class="nbLine">163</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>        return _("GNOME Speech Services")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">164</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">165</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    getFactoryName = staticmethod(getFactoryName)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">166</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">167</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def getSpeechServers():</pre></td>
</tr>
<tr class="">
  <td class="nbLine">168</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Gets available speech servers as a list.  The caller</pre></td>
</tr>
<tr class="">
  <td class="nbLine">169</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        is responsible for calling the shutdown() method of each</pre></td>
</tr>
<tr class="">
  <td class="nbLine">170</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        speech server returned.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">171</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">172</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">173</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Get a list of all the drivers on the system and find out how many</pre></td>
</tr>
<tr class="">
  <td class="nbLine">174</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # of them work.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">175</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">176</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>        knownServers = bonobo.activation.query(</pre></td>
</tr>
<tr class="">
  <td class="nbLine">177</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            "repo_ids.has('IDL:GNOME/Speech/SynthesisDriver:0.3')")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">178</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">179</td>
  <td class="nbHits">3</td>
  <td class="src"><pre>        for server in knownServers:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">180</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>            if not SpeechServer.__activeServers.has_key(server.iid):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">181</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>                try:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">182</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>                    SpeechServer.__createServer(server.iid)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">183</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                except:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">184</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    debug.printException(debug.LEVEL_WARNING)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">185</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">186</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>        return SpeechServer.__activeServers.values()</pre></td>
</tr>
<tr class="">
  <td class="nbLine">187</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">188</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    getSpeechServers = staticmethod(getSpeechServers)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">189</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">190</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def getSpeechServer(info=None):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">191</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Gets a given SpeechServer based upon the info.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">192</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        See SpeechServer.getInfo() for more info.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">193</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">194</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">195</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if info and SpeechServer.__activeServers.has_key(info[1]):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">196</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return SpeechServer.__activeServers[info[1]]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">197</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">198</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        server = None</pre></td>
</tr>
<tr class="">
  <td class="nbLine">199</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">200</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        gservers = bonobo.activation.query(</pre></td>
</tr>
<tr class="">
  <td class="nbLine">201</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            "repo_ids.has('IDL:GNOME/Speech/SynthesisDriver:0.3')")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">202</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">203</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if len(gservers) == 0:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">204</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return None</pre></td>
</tr>
<tr class="">
  <td class="nbLine">205</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">206</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        gserver = None</pre></td>
</tr>
<tr class="">
  <td class="nbLine">207</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">208</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # All this logic is to attempt to fall back to a working</pre></td>
</tr>
<tr class="">
  <td class="nbLine">209</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # driver if the desired one cannot be found or is not</pre></td>
</tr>
<tr class="">
  <td class="nbLine">210</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # not working.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">211</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">212</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if not info:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">213</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            gserver = gservers[0]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">214</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">215</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            for s in gservers:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">216</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if s.iid == info[1]:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">217</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    gserver = s</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">218</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    break</pre></td>
</tr>
<tr class="">
  <td class="nbLine">219</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">220</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if not gserver:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">221</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return None</pre></td>
</tr>
<tr class="">
  <td class="nbLine">222</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">223</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        server = None</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">224</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        try:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">225</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            server = SpeechServer.__createServer(gserver.iid)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">226</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        except:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">227</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            debug.printException(debug.LEVEL_WARNING)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">228</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">229</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if not server:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">230</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            for s in gservers:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">231</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                try:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">232</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    server = SpeechServer.__createServer(s.iid)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">233</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    if server:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">234</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        break</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">235</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                except:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">236</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    debug.printException(debug.LEVEL_WARNING)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">237</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">238</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        return server</pre></td>
</tr>
<tr class="">
  <td class="nbLine">239</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">240</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    getSpeechServer = staticmethod(getSpeechServer)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">241</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">242</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def shutdownActiveServers():</pre></td>
</tr>
<tr class="">
  <td class="nbLine">243</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Cleans up and shuts down this factory.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">244</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">245</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        for key in SpeechServer.__activeServers.keys():</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">246</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            server = SpeechServer.__activeServers[key]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">247</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            server.shutdown()</pre></td>
</tr>
<tr class="">
  <td class="nbLine">248</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">249</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    shutdownActiveServers = staticmethod(shutdownActiveServers)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">250</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">251</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def __init__(self, driver, iid):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">252</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>        speechserver.SpeechServer.__init__(self)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">253</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>        self.__speakers      = {}</pre></td>
</tr>
<tr class="">
  <td class="nbLine">254</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>        self.__pitchInfo     = {}</pre></td>
</tr>
<tr class="">
  <td class="nbLine">255</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>        self.__rateInfo      = {}</pre></td>
</tr>
<tr class="">
  <td class="nbLine">256</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>        self.__volumeInfo    = {}</pre></td>
</tr>
<tr class="">
  <td class="nbLine">257</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>        self.__driver        = driver</pre></td>
</tr>
<tr class="">
  <td class="nbLine">258</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>        self.__driverName    = driver.driverName</pre></td>
</tr>
<tr class="">
  <td class="nbLine">259</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>        self.__iid           = iid</pre></td>
</tr>
<tr class="">
  <td class="nbLine">260</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>        self.__sayAll        = None</pre></td>
</tr>
<tr class="">
  <td class="nbLine">261</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>        self.__isSpeaking    = False</pre></td>
</tr>
<tr class="">
  <td class="nbLine">262</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>        self.__eventQueue    = Queue.Queue(0)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">263</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>        self.__gidleId       = 0</pre></td>
</tr>
<tr class="">
  <td class="nbLine">264</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>        self.__gidleLock     = threading.Lock()</pre></td>
</tr>
<tr class="">
  <td class="nbLine">265</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>        self.__lastResetTime = 0</pre></td>
</tr>
<tr class="">
  <td class="nbLine">266</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">267</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def __getRate(self, speaker):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">268</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Gets the voice-independent ACSS rate value of a voice."""</pre></td>
</tr>
<tr class="">
  <td class="nbLine">269</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">270</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if not self.__rateInfo.has_key(speaker):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">271</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return 50.0</pre></td>
</tr>
<tr class="">
  <td class="nbLine">272</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">273</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        [minRate, averageRate, maxRate] = self.__rateInfo[speaker]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">274</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        rate = speaker.getParameterValue("rate")</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">275</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if rate &lt; averageRate:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">276</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return 50.0 * (rate - minRate) / (averageRate - minRate)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">277</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        elif rate &gt; averageRate:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">278</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return 50.0 \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">279</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                   + (50.0 * (rate - averageRate) / (maxRate - averageRate))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">280</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">281</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return 50.0</pre></td>
</tr>
<tr class="">
  <td class="nbLine">282</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">283</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def __setRate(self, speaker, acssRate):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">284</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Determines the voice-specific rate setting for the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">285</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        voice-independent ACSS rate value.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">286</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">287</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">288</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if not self.__rateInfo.has_key(speaker):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">289</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return</pre></td>
</tr>
<tr class="">
  <td class="nbLine">290</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">291</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        [minRate, averageRate, maxRate] = self.__rateInfo[speaker]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">292</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if acssRate &lt; 50.0:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">293</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            rate = minRate + acssRate * (averageRate - minRate) / 50.0</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">294</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        elif acssRate &gt; 50.0:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">295</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            rate = averageRate \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">296</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                   + (acssRate - 50.0) * (maxRate - averageRate) / 50.0</pre></td>
</tr>
<tr class="">
  <td class="nbLine">297</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">298</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            rate = averageRate</pre></td>
</tr>
<tr class="">
  <td class="nbLine">299</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">300</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        speaker.setParameterValue("rate", rate)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">301</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">302</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def __getPitch(self, speaker):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">303</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Gets the voice-specific pitch setting for the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">304</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           voice-independent ACSS pitch value.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">305</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">306</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Returns the voice-specific pitch setting.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">307</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">308</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">309</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if not self.__pitchInfo.has_key(speaker):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">310</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return 5.0</pre></td>
</tr>
<tr class="">
  <td class="nbLine">311</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">312</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        [minPitch, averagePitch, maxPitch] = self.__pitchInfo[speaker]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">313</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        pitch = speaker.getParameterValue("pitch")</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">314</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if pitch &lt; averagePitch:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">315</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return 5.0 * (pitch - minPitch) / (averagePitch - minPitch)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">316</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        elif pitch &gt; averagePitch:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">317</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return 5.0 \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">318</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                   + (5.0 * (pitch - averagePitch) / (maxPitch - averagePitch))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">319</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">320</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return 5.0</pre></td>
</tr>
<tr class="">
  <td class="nbLine">321</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">322</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def __setPitch(self, speaker, acssPitch):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">323</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Determines the voice-specific pitch setting for the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">324</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        voice-independent ACSS pitch value.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">325</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">326</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">327</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if not self.__pitchInfo.has_key(speaker):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">328</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return</pre></td>
</tr>
<tr class="">
  <td class="nbLine">329</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">330</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        [minPitch, averagePitch, maxPitch] = self.__pitchInfo[speaker]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">331</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if acssPitch &lt; 5.0:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">332</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            pitch = minPitch + acssPitch * (averagePitch - minPitch) / 5.0</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">333</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        elif acssPitch &gt; 5.0:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">334</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            pitch = averagePitch \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">335</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                    + (acssPitch - 5.0) * (maxPitch - averagePitch) / 5.0</pre></td>
</tr>
<tr class="">
  <td class="nbLine">336</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">337</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            pitch = averagePitch</pre></td>
</tr>
<tr class="">
  <td class="nbLine">338</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">339</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        speaker.setParameterValue("pitch", pitch)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">340</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">341</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def __setVolume(self, speaker, acssGain):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">342</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Determines the voice-specific rate setting for the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">343</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        voice-independent ACSS rate value.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">344</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">345</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">346</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if not self.__volumeInfo.has_key(speaker):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">347</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return</pre></td>
</tr>
<tr class="">
  <td class="nbLine">348</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">349</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        [minVolume, averageVolume, maxVolume] = self.__volumeInfo[speaker]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">350</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        volume = minVolume + acssGain * (maxVolume - minVolume) / 10.0</pre></td>
</tr>
<tr class="">
  <td class="nbLine">351</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">352</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        speaker.setParameterValue("volume", volume)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">353</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">354</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def __getSpeaker(self, acss=None):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">355</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">356</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        voices = settings.voices</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">357</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        defaultACSS = voices[settings.DEFAULT_VOICE]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">358</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">359</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if not acss:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">360</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            acss = defaultACSS</pre></td>
</tr>
<tr class="">
  <td class="nbLine">361</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">362</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if self.__speakers.has_key(acss.name()):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">363</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return self.__speakers[acss.name()]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">364</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">365</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Search for matching languages first, as that is the most</pre></td>
</tr>
<tr class="">
  <td class="nbLine">366</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # important thing.  We also try to look for the desired language</pre></td>
</tr>
<tr class="">
  <td class="nbLine">367</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # first, but then fall back to the default language.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">368</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">369</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        languages = []</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">370</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        try:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">371</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if acss.has_key(ACSS.FAMILY):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">372</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                family = acss[ACSS.FAMILY]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">373</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                languages = [family[speechserver.VoiceFamily.LOCALE]]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">374</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            elif defaultACSS.has_key(ACSS.FAMILY):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">375</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                family = defaultACSS[ACSS.FAMILY]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">376</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                languages = [family[speechserver.VoiceFamily.LOCALE]]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">377</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        except:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">378</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            pass</pre></td>
</tr>
<tr class="">
  <td class="nbLine">379</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">380</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # [[[TODO: WDW - I'm using an array of languages here because</pre></td>
</tr>
<tr class="">
  <td class="nbLine">381</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # it will give us the opportunity to provide a match for</pre></td>
</tr>
<tr class="">
  <td class="nbLine">382</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # gnome-speech driver implementations that do not designate</pre></td>
</tr>
<tr class="">
  <td class="nbLine">383</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # languages using the combination of ISO 639-1 and 3166-1</pre></td>
</tr>
<tr class="">
  <td class="nbLine">384</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # language_region strings (e.g., they use 'english' instead of</pre></td>
</tr>
<tr class="">
  <td class="nbLine">385</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # "en_US").  Thus, we could detect the default language is</pre></td>
</tr>
<tr class="">
  <td class="nbLine">386</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # "en_US" and just automatically append "english" and such to</pre></td>
</tr>
<tr class="">
  <td class="nbLine">387</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # the list to allow us to accomodate these kind of</pre></td>
</tr>
<tr class="">
  <td class="nbLine">388</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # variants.]]]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">389</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">390</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if len(languages) == 0:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">391</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            import locale</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">392</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            language, encoding = locale.getdefaultlocale()</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">393</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            languages = [language]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">394</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">395</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        voices = self.__driver.getAllVoices()</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">396</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        foundVoices = []</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">397</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        for voice in voices:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">398</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if voice.language in languages:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">399</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                foundVoices.append(voice)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">400</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">401</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # If we didn't find any matches, well...punt.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">402</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">403</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if len(foundVoices):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">404</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            voices = foundVoices</pre></td>
</tr>
<tr class="">
  <td class="nbLine">405</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">406</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            voices = self.__driver.getAllVoices()</pre></td>
</tr>
<tr class="">
  <td class="nbLine">407</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">408</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Now search for a matching family name.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">409</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">410</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        familyName = None</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">411</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if acss.has_key(ACSS.FAMILY):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">412</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            family = acss[ACSS.FAMILY]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">413</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            familyName = family[speechserver.VoiceFamily.NAME]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">414</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        elif defaultACSS.has_key(ACSS.FAMILY):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">415</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            family = defaultACSS[ACSS.FAMILY]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">416</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            familyName = family[speechserver.VoiceFamily.NAME]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">417</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">418</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        found = False</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">419</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        for voice in voices:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">420</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if (not familyName) or (voice.name == familyName):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">421</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                found = True</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">422</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                break</pre></td>
</tr>
<tr class="">
  <td class="nbLine">423</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">424</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if not found:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">425</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if len(voices) == 0:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">426</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                return None</pre></td>
</tr>
<tr class="">
  <td class="nbLine">427</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">428</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                voice = voices[0]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">429</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">430</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        s = self.__driver.createSpeaker(voice)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">431</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        speaker = _Speaker(s._narrow(GNOME.Speech.Speaker))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">432</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">433</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Turn off punctuation if the speaker allows us to do so.  We</pre></td>
</tr>
<tr class="">
  <td class="nbLine">434</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # do this because we want to handle spoken punctuation on our</pre></td>
</tr>
<tr class="">
  <td class="nbLine">435</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # own.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">436</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">437</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        try:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">438</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            speaker.setParameterValue("punctuation mode", 0.0)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">439</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        except:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">440</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            pass</pre></td>
</tr>
<tr class="">
  <td class="nbLine">441</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">442</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        speaker.registerCallback(self)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">443</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">444</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        parameters = speaker.getSupportedParameters()</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">445</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        for parameter in parameters:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">446</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if parameter.name == "rate":</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">447</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                self.__rateInfo[speaker] = \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">448</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                    [parameter.min, parameter.current, parameter.max]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">449</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            elif parameter.name == "pitch":</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">450</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                self.__pitchInfo[speaker] = \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">451</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                    [parameter.min, parameter.current, parameter.max]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">452</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            elif parameter.name == "volume":</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">453</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                self.__volumeInfo[speaker] = \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">454</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                    [parameter.min, parameter.current, parameter.max]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">455</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">456</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if acss.has_key(ACSS.RATE):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">457</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.__setRate(speaker, acss[ACSS.RATE])</pre></td>
</tr>
<tr class="">
  <td class="nbLine">458</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">459</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if acss.has_key(ACSS.AVERAGE_PITCH):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">460</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.__setPitch(speaker, acss[ACSS.AVERAGE_PITCH])</pre></td>
</tr>
<tr class="">
  <td class="nbLine">461</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">462</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if acss.has_key(ACSS.GAIN):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">463</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.__setVolume(speaker, acss[ACSS.GAIN])</pre></td>
</tr>
<tr class="">
  <td class="nbLine">464</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">465</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        self.__speakers[acss.name()] = speaker</pre></td>
</tr>
<tr class="">
  <td class="nbLine">466</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">467</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        return speaker</pre></td>
</tr>
<tr class="">
  <td class="nbLine">468</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">469</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def __idleHandler(self):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">470</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Called by the gidle thread when there is something to do.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">471</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        The goal is to try to do all AT-SPI interactions on the gidle</pre></td>
</tr>
<tr class="">
  <td class="nbLine">472</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        thread as a means to help prevent hangs."""</pre></td>
</tr>
<tr class="">
  <td class="nbLine">473</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">474</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Added in the notify method below.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">475</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">476</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # id     = the id of the utterance we sent to gnome-speech</pre></td>
</tr>
<tr class="">
  <td class="nbLine">477</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # type   = the type of progress we're getting</pre></td>
</tr>
<tr class="">
  <td class="nbLine">478</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # offset = character offset into the utterance</pre></td>
</tr>
<tr class="">
  <td class="nbLine">479</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">480</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        (id, type, offset) = self.__eventQueue.get()</pre></td>
</tr>
<tr class="">
  <td class="nbLine">481</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">482</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if self.__sayAll:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">483</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if self.__sayAll.idForCurrentContext == id:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">484</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                context = self.__sayAll.currentContext</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">485</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if type == GNOME.Speech.speech_callback_speech_started:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">486</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    context.currentOffset = context.startOffset</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">487</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    self.__sayAll.progressCallback(</pre></td>
</tr>
<tr class="">
  <td class="nbLine">488</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                        self.__sayAll.currentContext,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">489</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        speechserver.SayAllContext.PROGRESS)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">490</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                elif type == GNOME.Speech.speech_callback_speech_progress:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">491</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    context.currentOffset = context.startOffset + offset</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">492</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    self.__sayAll.progressCallback(</pre></td>
</tr>
<tr class="">
  <td class="nbLine">493</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                        self.__sayAll.currentContext,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">494</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        speechserver.SayAllContext.PROGRESS)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">495</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                elif type == GNOME.Speech.speech_callback_speech_ended:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">496</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    try:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">497</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        [self.__sayAll.currentContext, acss] = \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">498</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                            self.__sayAll.utteranceIterator.next()</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">499</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        debug.println(debug.LEVEL_INFO,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">500</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                      "SPEECH OUTPUT: '" \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">501</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                                      + self.__sayAll.currentContext.utterance\</pre></td>
</tr>
<tr class="">
  <td class="nbLine">502</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                                      + "'")</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">503</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        log.info("'%s'" \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">504</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                                 % self.__sayAll.currentContext.utterance)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">505</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        self.__sayAll.idForCurrentContext = self.__speak(</pre></td>
</tr>
<tr class="">
  <td class="nbLine">506</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                            self.__sayAll.currentContext.utterance,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">507</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            acss)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">508</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    except StopIteration:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">509</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        self.__isSpeaking = False</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">510</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        context.currentOffset = context.endOffset</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">511</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        self.__sayAll.progressCallback(</pre></td>
</tr>
<tr class="">
  <td class="nbLine">512</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                            self.__sayAll.currentContext,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">513</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            speechserver.SayAllContext.COMPLETED)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">514</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        self.__sayAll = None</pre></td>
</tr>
<tr class="">
  <td class="nbLine">515</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">516</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        rerun = True</pre></td>
</tr>
<tr class="">
  <td class="nbLine">517</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">518</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        self.__gidleLock.acquire()</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">519</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if self.__eventQueue.empty():</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">520</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.__gidleId = 0</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">521</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            rerun = False # destroy and don't call again</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">522</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        self.__gidleLock.release()</pre></td>
</tr>
<tr class="">
  <td class="nbLine">523</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">524</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        return rerun</pre></td>
</tr>
<tr class="">
  <td class="nbLine">525</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">526</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def notify(self, type, id, offset):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">527</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Called by GNOME Speech when the GNOME Speech driver generates</pre></td>
</tr>
<tr class="">
  <td class="nbLine">528</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        a callback.  This is for internal use only.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">529</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">530</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">531</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - type:   one of GNOME.Speech.speech_callback_speech_started,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">532</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                         GNOME.Speech.speech_callback_speech_progress,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">533</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                         GNOME.Speech.speech_callback_speech_ended</pre></td>
</tr>
<tr class="">
  <td class="nbLine">534</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - id:     the id of the utterance (returned by say)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">535</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - offset: the character offset into the utterance (for progress)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">536</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">537</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">538</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if type == GNOME.Speech.speech_callback_speech_started:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">539</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.__isSpeaking = True</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">540</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        elif type == GNOME.Speech.speech_callback_speech_progress:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">541</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.__isSpeaking = True</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">542</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        elif (type == GNOME.Speech.speech_callback_speech_ended) \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">543</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            and (not self.__sayAll):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">544</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.__isSpeaking = False</pre></td>
</tr>
<tr class="">
  <td class="nbLine">545</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">546</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if self.__sayAll:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">547</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.__gidleLock.acquire()</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">548</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.__eventQueue.put((id, type, offset))</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">549</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if not self.__gidleId:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">550</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if settings.gilSleepTime:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">551</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    time.sleep(settings.gilSleepTime)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">552</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                self.__gidleId = gobject.idle_add(self.__idleHandler)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">553</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.__gidleLock.release()</pre></td>
</tr>
<tr class="">
  <td class="nbLine">554</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">555</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def getInfo(self):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">556</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Returns [driverName, serverId]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">557</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">558</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        return [self.__driverName, self.__iid]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">559</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">560</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def getVoiceFamilies(self):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">561</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Returns a list of speechserver.VoiceFamily instances</pre></td>
</tr>
<tr class="">
  <td class="nbLine">562</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        representing all the voice families known by the speech server.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">563</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">564</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">565</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        families = []</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">566</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        try:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">567</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            for voice in self.__driver.getAllVoices():</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">568</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                props = {</pre></td>
</tr>
<tr class="">
  <td class="nbLine">569</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                    speechserver.VoiceFamily.NAME   : voice.name,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">570</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                    speechserver.VoiceFamily.LOCALE : voice.language</pre></td>
</tr>
<tr class="">
  <td class="nbLine">571</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                }</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">572</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                families.append(speechserver.VoiceFamily(props))</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">573</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        except:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">574</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            debug.printException(debug.LEVEL_SEVERE)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">575</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            pass</pre></td>
</tr>
<tr class="">
  <td class="nbLine">576</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">577</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        return families</pre></td>
</tr>
<tr class="">
  <td class="nbLine">578</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">579</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def queueText(self, text="", acss=None):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">580</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Adds the text to the queue.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">581</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">582</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">583</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - text: text to be spoken</pre></td>
</tr>
<tr class="">
  <td class="nbLine">584</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - acss: acss.ACSS instance; if None,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">585</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                the default voice settings will be used.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">586</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                Otherwise, the acss settings will be</pre></td>
</tr>
<tr class="">
  <td class="nbLine">587</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                used to augment/override the default</pre></td>
</tr>
<tr class="">
  <td class="nbLine">588</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                voice settings.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">589</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">590</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Output is produced by the next call to speak.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">591</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">592</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        self.speak(text, acss)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">593</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">594</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def queueTone(self, pitch=440, duration=50):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">595</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Adds a tone to the queue.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">596</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">597</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Output is produced by the next call to speak.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">598</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">599</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        pass</pre></td>
</tr>
<tr class="">
  <td class="nbLine">600</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">601</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def queueSilence(self, duration=50):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">602</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Adds silence to the queue.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">603</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">604</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Output is produced by the next call to speak.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">605</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">606</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        pass</pre></td>
</tr>
<tr class="">
  <td class="nbLine">607</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">608</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def speakCharacter(self, character, acss=None):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">609</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Speaks a single character immediately.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">610</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">611</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">612</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - character: text to be spoken</pre></td>
</tr>
<tr class="">
  <td class="nbLine">613</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - acss:      acss.ACSS instance; if None,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">614</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     the default voice settings will be used.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">615</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     Otherwise, the acss settings will be</pre></td>
</tr>
<tr class="">
  <td class="nbLine">616</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     used to augment/override the default</pre></td>
</tr>
<tr class="">
  <td class="nbLine">617</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     voice settings.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">618</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">619</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        self.speak(character, acss)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">620</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">621</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def speakUtterances(self, list, acss=None, interrupt=True):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">622</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Speaks the given list of utterances immediately.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">623</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">624</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">625</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - list:      list of strings to be spoken</pre></td>
</tr>
<tr class="">
  <td class="nbLine">626</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - acss:      acss.ACSS instance; if None,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">627</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     the default voice settings will be used.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">628</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     Otherwise, the acss settings will be</pre></td>
</tr>
<tr class="">
  <td class="nbLine">629</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     used to augment/override the default</pre></td>
</tr>
<tr class="">
  <td class="nbLine">630</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     voice settings.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">631</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - interrupt: if True, stop any speech currently in progress.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">632</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">633</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        i = 0</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">634</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        for text in list:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">635</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if len(text):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">636</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                self.speak(text, acss, interrupt and (i == 0))</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">637</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            i += 1</pre></td>
</tr>
<tr class="">
  <td class="nbLine">638</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">639</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def __addVerbalizedPunctuation(self, oldText):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">640</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Depending upon the users verbalized punctuation setting,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">641</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        adjust punctuation symbols in the given text to their pronounced</pre></td>
</tr>
<tr class="">
  <td class="nbLine">642</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        equivalents. The pronounced text will either replace the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">643</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        punctuation symbol or be inserted before it. In the latter case,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">644</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        this is to retain spoken prosity.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">645</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">646</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        If we are moving around by single characters, then always speak</pre></td>
</tr>
<tr class="">
  <td class="nbLine">647</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        the punctuation. We try to detect this by looking for just a</pre></td>
</tr>
<tr class="">
  <td class="nbLine">648</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        single character being spoken.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">649</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">650</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">651</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - oldText:      text to be parsed for punctuation.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">652</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">653</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Returns a text string with the punctuation symbols adjusted accordingly.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">654</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">655</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">656</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        ## Replace ellipses (both manual and UTF-8) with "dot dot dot"</pre></td>
</tr>
<tr class="">
  <td class="nbLine">657</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        ##</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">658</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        oldText = oldText.replace("...", _(" dot dot dot"), 1)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">659</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        oldText = oldText.replace("\342\200\246",  _(" dot dot dot"), 1)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">660</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        oldText = oldText.decode("UTF-8")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">661</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">662</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        ## Don't speak newlines unless the user is moving through text</pre></td>
</tr>
<tr class="">
  <td class="nbLine">663</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        ## using a right or left arrow key.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">664</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        ##</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">665</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        removeNewLines = True</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">666</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if orca_state.lastInputEvent and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">667</td>
  <td class="nbHits"></td>
  <td class="src"><pre>               orca_state.lastInputEvent.__dict__.has_key("event_string"):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">668</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            lastKey = orca_state.lastInputEvent.event_string</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">669</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if lastKey == "Left" or lastKey == "Right":</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">670</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                removeNewLines = False</pre></td>
</tr>
<tr class="">
  <td class="nbLine">671</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">672</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if removeNewLines:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">673</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            oldText = oldText.replace("\n", "", 1)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">674</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">675</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        style = settings.verbalizePunctuationStyle</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">676</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        newText = ''</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">677</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        for i in range(0, len(oldText)):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">678</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            try:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">679</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                level, action = \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">680</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                    punctuation_settings.getPunctuationInfo(oldText[i])</pre></td>
</tr>
<tr class="">
  <td class="nbLine">681</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">682</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                # Special case for punctuation in text like filenames or URL's:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">683</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">684</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                isPrev = isNext = isSpecial = False</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">685</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if i &gt; 0:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">686</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    isPrev = not (oldText[i - 1] in string.whitespace)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">687</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if i &lt; (len(oldText) - 1):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">688</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    isNext = not (oldText[i + 1] in string.whitespace)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">689</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">690</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                # If this is a period and there is a non-space character</pre></td>
</tr>
<tr class="">
  <td class="nbLine">691</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                # on either side of it, then always speak it.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">692</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">693</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                isSpecial = isPrev and isNext and (oldText[i] == ".")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">694</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">695</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                # If this is a dash and the users punctuation level is not</pre></td>
</tr>
<tr class="">
  <td class="nbLine">696</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                # NONE and the previous character is a white space character,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">697</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                # and the next character is a dollar sign or a digit, then</pre></td>
</tr>
<tr class="">
  <td class="nbLine">698</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                # always speak it. See bug #392939.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">699</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">700</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                prevCharMatches = nextCharMatches = False</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">701</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if orca_state.activeScript:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">702</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    currencySymbols = \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">703</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                        orca_state.activeScript.getUnicodeCurrencySymbols()</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">704</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if i &gt; 0:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">705</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    prevCharMatches = (oldText[i - 1] in string.whitespace)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">706</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if i &lt; (len(oldText) - 1):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">707</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    nextCharMatches = (oldText[i + 1] in string.digits or \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">708</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                                       oldText[i + 1] in currencySymbols)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">709</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">710</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if oldText[i] == "-" and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">711</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                   style != settings.PUNCTUATION_STYLE_NONE and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">712</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                   prevCharMatches and nextCharMatches:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">713</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    if isPrev:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">714</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        newText += " "</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">715</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    newText += _("minus")</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">716</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                elif (len(oldText) == 1) or isSpecial or (style &lt;= level):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">717</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    if isPrev:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">718</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        newText += " "</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">719</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    newText += chnames.getCharacterName(oldText[i])</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">720</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    if (action == punctuation_settings.PUNCTUATION_INSERT) \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">721</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                        and not isNext:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">722</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        newText += oldText[i].encode("UTF-8")</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">723</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    if isNext:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">724</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        newText += " "</pre></td>
</tr>
<tr class="">
  <td class="nbLine">725</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">726</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    newText += oldText[i].encode("UTF-8")</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">727</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            except:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">728</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if (len(oldText) == 1):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">729</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    newText += chnames.getCharacterName(oldText[i])</pre></td>
</tr>
<tr class="">
  <td class="nbLine">730</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">731</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    newText += oldText[i].encode("UTF-8")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">732</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">733</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        return newText</pre></td>
</tr>
<tr class="">
  <td class="nbLine">734</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">735</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def __speak(self, text=None, acss=None, interrupt=True):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">736</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Speaks all queued text immediately.  If text is not None,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">737</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        it is added to the queue before speaking.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">738</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">739</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">740</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - text:      optional text to add to the queue before speaking</pre></td>
</tr>
<tr class="">
  <td class="nbLine">741</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - acss:      acss.ACSS instance; if None,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">742</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     the default voice settings will be used.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">743</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     Otherwise, the acss settings will be</pre></td>
</tr>
<tr class="">
  <td class="nbLine">744</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     used to augment/override the default</pre></td>
</tr>
<tr class="">
  <td class="nbLine">745</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     voice settings.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">746</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - interrupt: if True, stops any speech in progress before</pre></td>
</tr>
<tr class="">
  <td class="nbLine">747</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     speaking the text</pre></td>
</tr>
<tr class="">
  <td class="nbLine">748</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">749</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Returns an id of the thing being spoken or -1 if nothing is to</pre></td>
</tr>
<tr class="">
  <td class="nbLine">750</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        be spoken.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">751</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">752</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">753</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # If the user has speech turned off, just return.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">754</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">755</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if not settings.enableSpeech:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">756</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return -1</pre></td>
</tr>
<tr class="">
  <td class="nbLine">757</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">758</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        speaker = self.__getSpeaker(acss)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">759</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if acss and not acss.has_key(ACSS.RATE):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">760</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            voices = settings.voices</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">761</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            defaultACSS = voices[settings.DEFAULT_VOICE]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">762</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if defaultACSS.has_key(ACSS.RATE):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">763</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                self.__setRate(speaker, defaultACSS[ACSS.RATE])</pre></td>
</tr>
<tr class="">
  <td class="nbLine">764</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">765</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if not text:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">766</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if interrupt:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">767</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                speech.stop()</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">768</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return -1</pre></td>
</tr>
<tr class="">
  <td class="nbLine">769</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">770</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        text = self.__addVerbalizedPunctuation(text)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">771</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if orca_state.activeScript:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">772</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            text = orca_state.activeScript.adjustForPronunciation(text)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">773</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">774</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        try:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">775</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # [[[TODO: WDW - back this stop out for now.  The problem is</pre></td>
</tr>
<tr class="">
  <td class="nbLine">776</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # that we end up clipping too much speech, especially in the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">777</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # case where we want to speak the contents of a popup before</pre></td>
</tr>
<tr class="">
  <td class="nbLine">778</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # speaking the object with focus.]]]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">779</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">780</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            #if interrupt:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">781</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            #    speaker.stop()</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">782</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.__lastText = [text, acss]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">783</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.__isSpeaking = True</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">784</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return speaker.say(text)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">785</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        except:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">786</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # On failure, remember what we said, reset our connection to the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">787</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # speech synthesis driver, and try to say it again.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">788</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">789</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            debug.printException(debug.LEVEL_SEVERE)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">790</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            debug.println(debug.LEVEL_SEVERE, "Restarting speech...")</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">791</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.reset()</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">792</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return -1</pre></td>
</tr>
<tr class="">
  <td class="nbLine">793</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">794</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def speak(self, text=None, acss=None, interrupt=True):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">795</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Speaks all queued text immediately.  If text is not None,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">796</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        it is added to the queue before speaking.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">797</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">798</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">799</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - text:      optional text to add to the queue before speaking</pre></td>
</tr>
<tr class="">
  <td class="nbLine">800</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - acss:      acss.ACSS instance; if None,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">801</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     the default voice settings will be used.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">802</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     Otherwise, the acss settings will be</pre></td>
</tr>
<tr class="">
  <td class="nbLine">803</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     used to augment/override the default</pre></td>
</tr>
<tr class="">
  <td class="nbLine">804</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     voice settings.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">805</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - interrupt: if True, stops any speech in progress before</pre></td>
</tr>
<tr class="">
  <td class="nbLine">806</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     speaking the text</pre></td>
</tr>
<tr class="">
  <td class="nbLine">807</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">808</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if self.__sayAll:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">809</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.stop()</pre></td>
</tr>
<tr class="">
  <td class="nbLine">810</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">811</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        self.__speak(text, acss, interrupt)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">812</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">813</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def isSpeaking(self):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">814</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """"Returns True if the system is currently speaking."""</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">815</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        return self.__isSpeaking</pre></td>
</tr>
<tr class="">
  <td class="nbLine">816</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">817</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def sayAll(self, utteranceIterator, progressCallback):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">818</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Iterates through the given utteranceIterator, speaking</pre></td>
</tr>
<tr class="">
  <td class="nbLine">819</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        each utterance one at a time.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">820</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">821</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">822</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - utteranceIterator: iterator/generator whose next() function</pre></td>
</tr>
<tr class="">
  <td class="nbLine">823</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                             returns a new string to be spoken</pre></td>
</tr>
<tr class="">
  <td class="nbLine">824</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - progressCallback:  called as progress is made</pre></td>
</tr>
<tr class="">
  <td class="nbLine">825</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">826</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        try:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">827</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            [context, acss] = utteranceIterator.next()</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">828</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            debug.println(debug.LEVEL_INFO,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">829</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                          "SPEECH OUTPUT: '" + context.utterance + "'")</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">830</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            log.info("'%s'" % context.utterance)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">831</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.__sayAll = _SayAll(utteranceIterator,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">832</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                    context,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">833</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                    self.__speak(context.utterance, acss),</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">834</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                    progressCallback)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">835</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        except StopIteration:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">836</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            pass</pre></td>
</tr>
<tr class="">
  <td class="nbLine">837</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">838</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def increaseSpeechPitch(self, step=0.5):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">839</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Increases the speech pitch for the default voice.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">840</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">841</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">842</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - step: the pitch step increment.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">843</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">844</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">845</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # [[[TODO: richb - this is a hack for now.  Need to take min/max</pre></td>
</tr>
<tr class="">
  <td class="nbLine">846</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # values in account, plus also need to take into account that</pre></td>
</tr>
<tr class="">
  <td class="nbLine">847</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # different engines provide different pitch ranges.]]]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">848</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">849</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        voices = settings.voices</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">850</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        acss = voices[settings.DEFAULT_VOICE]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">851</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        speaker = self.__getSpeaker(acss)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">852</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">853</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        pitchDelta = settings.speechPitchDelta</pre></td>
</tr>
<tr class="">
  <td class="nbLine">854</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">855</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        try:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">856</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            pitch = min(10, self.__getPitch(speaker) + pitchDelta)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">857</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            acss[ACSS.AVERAGE_PITCH] = pitch</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">858</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.__setPitch(speaker, pitch)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">859</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            debug.println(debug.LEVEL_CONFIGURATION,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">860</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                          "speech.increaseSpeechPitch: pitch is now " \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">861</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                          " %d" % pitch)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">862</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.speak(_("higher."))</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">863</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        except:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">864</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            debug.printException(debug.LEVEL_SEVERE)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">865</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">866</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def decreaseSpeechPitch(self, step=0.5):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">867</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Decreases the speech pitch for the default voice.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">868</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">869</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">870</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - step: the pitch step decrement.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">871</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">872</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">873</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # [[[TODO: WDW - this is a hack for now.  Need to take min/max</pre></td>
</tr>
<tr class="">
  <td class="nbLine">874</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # values in account, plus also need to take into account that</pre></td>
</tr>
<tr class="">
  <td class="nbLine">875</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # different engines provide different rate ranges.]]]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">876</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">877</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        voices = settings.voices</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">878</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        acss = voices[settings.DEFAULT_VOICE]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">879</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        speaker = self.__getSpeaker(acss)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">880</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">881</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        pitchDelta = settings.speechPitchDelta</pre></td>
</tr>
<tr class="">
  <td class="nbLine">882</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">883</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        try:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">884</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            pitch = max(1, self.__getPitch(speaker) - pitchDelta)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">885</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            acss[ACSS.AVERAGE_PITCH] = pitch</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">886</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.__setPitch(speaker, pitch)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">887</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            debug.println(debug.LEVEL_CONFIGURATION,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">888</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                          "speech.decreaseSpeechPitch: pitch is now " \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">889</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                          " %d" % pitch)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">890</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.speak(_("lower."))</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">891</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        except:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">892</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            debug.printException(debug.LEVEL_SEVERE)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">893</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">894</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def increaseSpeechRate(self, step=5):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">895</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Increases the speech rate.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">896</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">897</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        [[[TODO: WDW - this is a hack for now.  Need to take min/max</pre></td>
</tr>
<tr class="">
  <td class="nbLine">898</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        values in account, plus also need to take into account that</pre></td>
</tr>
<tr class="">
  <td class="nbLine">899</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        different engines provide different rate ranges.]]]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">900</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">901</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">902</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        voices = settings.voices</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">903</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        acss = voices[settings.DEFAULT_VOICE]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">904</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        speaker = self.__getSpeaker(acss)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">905</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">906</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        rateDelta = settings.speechRateDelta</pre></td>
</tr>
<tr class="">
  <td class="nbLine">907</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">908</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        try:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">909</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            rate = min(100, self.__getRate(speaker) + rateDelta)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">910</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            acss[ACSS.RATE] = rate</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">911</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.__setRate(speaker, rate)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">912</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            debug.println(debug.LEVEL_CONFIGURATION,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">913</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                          "speech.increaseSpeechRate: rate is now " \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">914</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                          " %d" % rate)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">915</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.speak(_("faster."))</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">916</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        except:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">917</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            debug.printException(debug.LEVEL_SEVERE)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">918</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">919</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def decreaseSpeechRate(self, step=5):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">920</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Decreases the rate of speech for the given ACSS.  If</pre></td>
</tr>
<tr class="">
  <td class="nbLine">921</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        acssName is None, the rate decrease will be applied to all</pre></td>
</tr>
<tr class="">
  <td class="nbLine">922</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        known ACSSs.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">923</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">924</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        [[[TODO: WDW - this is a hack for now.  Need to take min/max</pre></td>
</tr>
<tr class="">
  <td class="nbLine">925</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        values in account, plus also need to take into account that</pre></td>
</tr>
<tr class="">
  <td class="nbLine">926</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        different engines provide different rate ranges.]]]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">927</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">928</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">929</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        -acssName: the ACSS whose speech rate should be decreased</pre></td>
</tr>
<tr class="">
  <td class="nbLine">930</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">931</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">932</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        voices = settings.voices</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">933</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        acss = voices[settings.DEFAULT_VOICE]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">934</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        speaker = self.__getSpeaker(acss)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">935</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">936</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        rateDelta = settings.speechRateDelta</pre></td>
</tr>
<tr class="">
  <td class="nbLine">937</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">938</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        try:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">939</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            rate = max(1, self.__getRate(speaker) - rateDelta)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">940</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            acss[ACSS.RATE] = rate</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">941</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.__setRate(speaker, rate)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">942</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            debug.println(debug.LEVEL_CONFIGURATION,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">943</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                          "speech.decreaseSpeechRate: rate is now " \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">944</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                          " %d" % rate)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">945</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.speak(_("slower."))</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">946</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        except:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">947</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            debug.printException(debug.LEVEL_SEVERE)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">948</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">949</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def stop(self):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">950</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Stops ongoing speech and flushes the queue."""</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">951</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if self.__sayAll:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">952</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.__sayAll.progressCallback(</pre></td>
</tr>
<tr class="">
  <td class="nbLine">953</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                self.__sayAll.currentContext,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">954</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                speechserver.SayAllContext.INTERRUPTED)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">955</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.__sayAll = None</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">956</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        for name in self.__speakers.keys():</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">957</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            try:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">958</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                self.__speakers[name].stop()</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">959</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            except:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">960</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                pass</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">961</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        self.__isSpeaking = False</pre></td>
</tr>
<tr class="">
  <td class="nbLine">962</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">963</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def shutdown(self):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">964</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Shuts down the speech engine."""</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">965</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if SpeechServer.__activeServers.has_key(self.__iid):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">966</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            for speaker in self.__speakers.values():</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">967</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                speaker.stop()</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">968</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                speaker.unref()</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">969</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.__speakers = {}</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">970</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            try:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">971</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                self.__driver.unref()</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">972</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            except:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">973</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                pass</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">974</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.__driver = None</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">975</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            del SpeechServer.__activeServers[self.__iid]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">976</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">977</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def reset(self, text=None, acss=None):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">978</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Resets the speech engine."""</pre></td>
</tr>
<tr class="">
  <td class="nbLine">979</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">980</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # We might get into a vicious loop of resetting speech, so</pre></td>
</tr>
<tr class="">
  <td class="nbLine">981</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # we will abort if we see this happening.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">982</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">983</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if (time.time() - self.__lastResetTime) &lt; 20:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">984</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            debug.println(debug.LEVEL_SEVERE,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">985</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                          "Something looks wrong with speech.  Aborting.")</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">986</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            debug.printStack(debug.LEVEL_ALL)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">987</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            os._exit(50)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">988</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">989</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.__lastResetTime = time.time()</pre></td>
</tr>
<tr class="">
  <td class="nbLine">990</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">991</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        speakers = self.__speakers</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">992</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        self.shutdown()</pre></td>
</tr>
<tr class="">
  <td class="nbLine">993</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">994</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        servers = bonobo.activation.query(</pre></td>
</tr>
<tr class="">
  <td class="nbLine">995</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            "repo_ids.has('IDL:GNOME/Speech/SynthesisDriver:0.3')")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">996</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">997</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        for server in servers:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">998</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if server.iid == self.__iid:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">999</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                try:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1000</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    self.__driver = self.__activateDriver(self.__iid)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1001</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    self.__speakers = {}</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1002</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    for name in speakers.keys():</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1003</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        self.__getSpeaker(speakers[name])</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1004</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    if text:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1005</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        self.speak(text, acss)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1006</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    break</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1007</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                except:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1008</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    debug.printException(debug.LEVEL_SEVERE)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1009</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    self.__driver = None</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1010</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    pass</pre></td>
</tr>

</tbody>
</table>


<p class="footer">
Report generated by <a href="http://cheeseshop.python.org/pypi/trace2html"
>trace2html</a> on 2007-03-07 09:42:33.162938.
</p>

</body>

</html>
