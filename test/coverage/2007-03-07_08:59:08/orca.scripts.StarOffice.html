<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <title>Coverage Report - orca.scripts.StarOffice</title>
  <link title="Style" type="text/css" rel="stylesheet" href="trace2html.css"/>
  <script type="text/javascript" src="sortabletable.js"></script>
</head>

<body>
<h1>Coverage Report - orca.scripts.StarOffice</h1>

<table id="summary" class="summary">
<thead>
  <tr><td>Module</td><td>Coverage %</td></tr>
</thead>
<tbody>
<tr class=even>
  <td class="moduleName">
    <a href="orca.scripts.StarOffice.html">orca.scripts.StarOffice</a></td>
  <td class="percent">
    <div class="coveragePercent">
      35%
    </div>
    <div class="coverageBar">
      <div class="inCoverageBar" style="width: 35%">
      </div>
    </div>
  </td>
</tr>

</tbody>
</table>
<script type="text/javascript">
var packageTable = new SortableTable(document.getElementById("summary"),
    ["String", "Percentage"]);
packageTable.sort(0);
</script>


<table class="srcCode">
<tbody>
<tr class="">
  <td class="nbLine">1</td>
  <td class="nbHits"></td>
  <td class="src"><pre># Orca</pre></td>
</tr>
<tr class="">
  <td class="nbLine">2</td>
  <td class="nbHits"></td>
  <td class="src"><pre>#</pre></td>
</tr>
<tr class="">
  <td class="nbLine">3</td>
  <td class="nbHits"></td>
  <td class="src"><pre># Copyright 2005-2006 Sun Microsystems Inc.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">4</td>
  <td class="nbHits"></td>
  <td class="src"><pre>#</pre></td>
</tr>
<tr class="">
  <td class="nbLine">5</td>
  <td class="nbHits"></td>
  <td class="src"><pre># This library is free software; you can redistribute it and/or</pre></td>
</tr>
<tr class="">
  <td class="nbLine">6</td>
  <td class="nbHits"></td>
  <td class="src"><pre># modify it under the terms of the GNU Library General Public</pre></td>
</tr>
<tr class="">
  <td class="nbLine">7</td>
  <td class="nbHits"></td>
  <td class="src"><pre># License as published by the Free Software Foundation; either</pre></td>
</tr>
<tr class="">
  <td class="nbLine">8</td>
  <td class="nbHits"></td>
  <td class="src"><pre># version 2 of the License, or (at your option) any later version.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">9</td>
  <td class="nbHits"></td>
  <td class="src"><pre>#</pre></td>
</tr>
<tr class="">
  <td class="nbLine">10</td>
  <td class="nbHits"></td>
  <td class="src"><pre># This library is distributed in the hope that it will be useful,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">11</td>
  <td class="nbHits"></td>
  <td class="src"><pre># but WITHOUT ANY WARRANTY; without even the implied warranty of</pre></td>
</tr>
<tr class="">
  <td class="nbLine">12</td>
  <td class="nbHits"></td>
  <td class="src"><pre># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</pre></td>
</tr>
<tr class="">
  <td class="nbLine">13</td>
  <td class="nbHits"></td>
  <td class="src"><pre># Library General Public License for more details.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">14</td>
  <td class="nbHits"></td>
  <td class="src"><pre>#</pre></td>
</tr>
<tr class="">
  <td class="nbLine">15</td>
  <td class="nbHits"></td>
  <td class="src"><pre># You should have received a copy of the GNU Library General Public</pre></td>
</tr>
<tr class="">
  <td class="nbLine">16</td>
  <td class="nbHits"></td>
  <td class="src"><pre># License along with this library; if not, write to the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">17</td>
  <td class="nbHits"></td>
  <td class="src"><pre># Free Software Foundation, Inc., 59 Temple Place - Suite 330,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">18</td>
  <td class="nbHits"></td>
  <td class="src"><pre># Boston, MA 02111-1307, USA.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">19</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">20</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>"""Custom script for StarOffice and OpenOffice."""</pre></td>
</tr>
<tr class="">
  <td class="nbLine">21</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">22</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>__id__        = "$Id: StarOffice.py 2126 2007-03-06 21:35:17Z richb $"</pre></td>
</tr>
<tr class="">
  <td class="nbLine">23</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>__version__   = "$Revision: 2126 $"</pre></td>
</tr>
<tr class="">
  <td class="nbLine">24</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>__date__      = "$Date: 2007-03-06 13:35:17 -0800 (Tue, 06 Mar 2007) $"</pre></td>
</tr>
<tr class="">
  <td class="nbLine">25</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>__copyright__ = "Copyright (c) 2005-2006 Sun Microsystems Inc."</pre></td>
</tr>
<tr class="">
  <td class="nbLine">26</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>__license__   = "LGPL"</pre></td>
</tr>
<tr class="">
  <td class="nbLine">27</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">28</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import orca.debug as debug</pre></td>
</tr>
<tr class="">
  <td class="nbLine">29</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import orca.atspi as atspi</pre></td>
</tr>
<tr class="">
  <td class="nbLine">30</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import orca.chnames as chnames</pre></td>
</tr>
<tr class="">
  <td class="nbLine">31</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import orca.default as default</pre></td>
</tr>
<tr class="">
  <td class="nbLine">32</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import orca.input_event as input_event</pre></td>
</tr>
<tr class="">
  <td class="nbLine">33</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import orca.rolenames as rolenames</pre></td>
</tr>
<tr class="">
  <td class="nbLine">34</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import orca.braille as braille</pre></td>
</tr>
<tr class="">
  <td class="nbLine">35</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import orca.braillegenerator as braillegenerator</pre></td>
</tr>
<tr class="">
  <td class="nbLine">36</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import orca.orca as orca</pre></td>
</tr>
<tr class="">
  <td class="nbLine">37</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import orca.orca_state as orca_state</pre></td>
</tr>
<tr class="">
  <td class="nbLine">38</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import orca.speech as speech</pre></td>
</tr>
<tr class="">
  <td class="nbLine">39</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import orca.speechgenerator as speechgenerator</pre></td>
</tr>
<tr class="">
  <td class="nbLine">40</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import orca.settings as settings</pre></td>
</tr>
<tr class="">
  <td class="nbLine">41</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>import orca.keybindings as keybindings</pre></td>
</tr>
<tr class="">
  <td class="nbLine">42</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">43</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>from orca.orca_i18n import _ # for gettext support</pre></td>
</tr>
<tr class="">
  <td class="nbLine">44</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">45</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>inputLineForCell = None</pre></td>
</tr>
<tr class="">
  <td class="nbLine">46</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">47</td>
  <td class="nbHits"></td>
  <td class="src"><pre># Dictionaries for the calc dynamic row and column headers.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">48</td>
  <td class="nbHits"></td>
  <td class="src"><pre>#</pre></td>
</tr>
<tr class="">
  <td class="nbLine">49</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>dynamicColumnHeaders = {}</pre></td>
</tr>
<tr class="">
  <td class="nbLine">50</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>dynamicRowHeaders = {}</pre></td>
</tr>
<tr class="">
  <td class="nbLine">51</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">52</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>def adjustForWriterTable(obj):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">53</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    """Check to see if we are in Writer, where the object with focus is a</pre></td>
</tr>
<tr class="">
  <td class="nbLine">54</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    paragraph, and the parent is the table cell. If it is, then, return the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">55</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    parent table cell otherwise return the current object.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">56</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">57</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">58</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    - obj: the accessible object to check.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">59</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">60</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    Returns parent table cell (if in a Writer table ) or the current object.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">61</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">62</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">63</td>
  <td class="nbHits">11</td>
  <td class="src"><pre>    if obj.role == rolenames.ROLE_PARAGRAPH and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">64</td>
  <td class="nbHits"></td>
  <td class="src"><pre>       obj.parent.role == rolenames.ROLE_TABLE_CELL:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">65</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        return obj.parent</pre></td>
</tr>
<tr class="">
  <td class="nbLine">66</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    else:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">67</td>
  <td class="nbHits">11</td>
  <td class="src"><pre>        return obj</pre></td>
</tr>
<tr class="">
  <td class="nbLine">68</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">69</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>def getTable(obj):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">70</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    """Get the table that this table cell is in.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">71</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">72</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">73</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    - obj: the table cell.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">74</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">75</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    Return the table that this table cell is in, or None if this object</pre></td>
</tr>
<tr class="">
  <td class="nbLine">76</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    isn't in a table.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">77</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">78</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">79</td>
  <td class="nbHits">11</td>
  <td class="src"><pre>    table = None</pre></td>
</tr>
<tr class="">
  <td class="nbLine">80</td>
  <td class="nbHits">11</td>
  <td class="src"><pre>    obj = adjustForWriterTable(obj)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">81</td>
  <td class="nbHits">11</td>
  <td class="src"><pre>    if obj.role == rolenames.ROLE_TABLE_CELL and obj.parent:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">82</td>
  <td class="nbHits">11</td>
  <td class="src"><pre>        table = obj.parent.table</pre></td>
</tr>
<tr class="">
  <td class="nbLine">83</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">84</td>
  <td class="nbHits">11</td>
  <td class="src"><pre>    return table</pre></td>
</tr>
<tr class="">
  <td class="nbLine">85</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">86</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>def getDynamicColumnHeaderCell(obj, column):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">87</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    """Given a table cell, return the dynamic column header cell associated</pre></td>
</tr>
<tr class="">
  <td class="nbLine">88</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    with it.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">89</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">90</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">91</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    - obj: the table cell.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">92</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    - column: the column that this dynamic header is on.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">93</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">94</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    Return the dynamic column header cell associated with the given table cell.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">95</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">96</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">97</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>    obj = adjustForWriterTable(obj)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">98</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>    accCell = None</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">99</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>    parent = obj.parent</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">100</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>    if parent and parent.table:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">101</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        row = parent.table.getRowAtIndex(obj.index)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">102</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        cell = parent.table.getAccessibleAt(row, column)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">103</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        accCell = atspi.Accessible.makeAccessible(cell)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">104</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">105</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>    return accCell</pre></td>
</tr>
<tr class="">
  <td class="nbLine">106</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">107</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>def getDynamicRowHeaderCell(obj, row):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">108</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    """Given a table cell, return the dynamic row header cell associated</pre></td>
</tr>
<tr class="">
  <td class="nbLine">109</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    with it.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">110</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">111</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">112</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    - obj: the table cell.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">113</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    - row: the row that this dynamic header is on.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">114</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">115</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    Return the dynamic row header cell associated with the given table cell.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">116</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">117</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">118</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>    obj = adjustForWriterTable(obj)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">119</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>    accCell = None</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">120</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>    parent = obj.parent</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">121</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>    if parent and parent.table:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">122</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        column = parent.table.getColumnAtIndex(obj.index)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">123</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        cell = parent.table.getAccessibleAt(row, column)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">124</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        accCell = atspi.Accessible.makeAccessible(cell)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">125</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">126</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>    return accCell</pre></td>
</tr>
<tr class="">
  <td class="nbLine">127</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">128</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>def locateInputLine(obj):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">129</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    """Return the spread sheet input line. This only needs to be found</pre></td>
</tr>
<tr class="">
  <td class="nbLine">130</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    the very first time a spread sheet table cell gets focus. We use the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">131</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    table cell to work back up the component hierarchy until we have found</pre></td>
</tr>
<tr class="">
  <td class="nbLine">132</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    the common panel that both it and the input line reside in. We then</pre></td>
</tr>
<tr class="">
  <td class="nbLine">133</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    use that as the base component to search for a component which has a</pre></td>
</tr>
<tr class="">
  <td class="nbLine">134</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    paragraph role. This will be the input line.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">135</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">136</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">137</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    - obj: the spread sheet table cell that has just got focus.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">138</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">139</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    Returns the spread sheet input line component.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">140</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">141</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">142</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>    inputLine = None</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">143</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>    panel = obj.parent.parent.parent.parent</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">144</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>    if panel and panel.role == rolenames.ROLE_PANEL:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">145</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        allParagraphs = self.findByRole(panel, rolenames.ROLE_PARAGRAPH)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">146</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if len(allParagraphs) == 1:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">147</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            inputLine = allParagraphs[0]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">148</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">149</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            debug.println(debug.LEVEL_SEVERE,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">150</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                  "StarOffice: locateInputLine: incorrect paragraph count.")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">151</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">152</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        debug.println(debug.LEVEL_SEVERE,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">153</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                  "StarOffice: locateInputLine: couldn't find common panel.")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">154</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">155</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>    return inputLine</pre></td>
</tr>
<tr class="">
  <td class="nbLine">156</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">157</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>def isSpreadSheetCell(obj):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">158</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    """Return an indication of whether the given obj is a spread sheet</pre></td>
</tr>
<tr class="">
  <td class="nbLine">159</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    table cell.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">160</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">161</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">162</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    - obj: the object to check.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">163</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">164</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    Returns True if this is a table cell, False otherwise.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">165</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">166</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">167</td>
  <td class="nbHits">11</td>
  <td class="src"><pre>    found = False</pre></td>
</tr>
<tr class="">
  <td class="nbLine">168</td>
  <td class="nbHits">11</td>
  <td class="src"><pre>    rolesList = [rolenames.ROLE_TABLE_CELL, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">169</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                 rolenames.ROLE_TABLE, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">170</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                 rolenames.ROLE_UNKNOWN, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">171</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                 rolenames.ROLE_SCROLL_PANE, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">172</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                 rolenames.ROLE_PANEL, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">173</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                 rolenames.ROLE_ROOT_PANE, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">174</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                 rolenames.ROLE_FRAME, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">175</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                 rolenames.ROLE_APPLICATION]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">176</td>
  <td class="nbHits">11</td>
  <td class="src"><pre>    if self.isDesiredFocusedItem(obj, rolesList):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">177</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # We've found a table cell with the correct hierarchy. Now check</pre></td>
</tr>
<tr class="">
  <td class="nbLine">178</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # that we are in a spreadsheet as opposed to the writer application.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">179</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # See bug #382408.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">180</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">181</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        current = obj.parent</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">182</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        while current.role != rolenames.ROLE_APPLICATION:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">183</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if current.role == rolenames.ROLE_FRAME and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">184</td>
  <td class="nbHits"></td>
  <td class="src"><pre>               (current.name and current.name.endswith(_("Calc"))):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">185</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                found = True</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">186</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            current = current.parent</pre></td>
</tr>
<tr class="">
  <td class="nbLine">187</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">188</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>    return found</pre></td>
</tr>
<tr class="">
  <td class="nbLine">189</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">190</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>class BrailleGenerator(braillegenerator.BrailleGenerator):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">191</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    """Overrides _getBrailleRegionsForTableCellRow so that , when we are</pre></td>
</tr>
<tr class="">
  <td class="nbLine">192</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    in a spread sheet, we can braille the dynamic row and column headers</pre></td>
</tr>
<tr class="">
  <td class="nbLine">193</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    (assuming they are set).</pre></td>
</tr>
<tr class="">
  <td class="nbLine">194</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    Overrides _getBrailleRegionsForTableCell so that, when we are in</pre></td>
</tr>
<tr class="">
  <td class="nbLine">195</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    a spread sheet, we can braille the location of the table cell as well</pre></td>
</tr>
<tr class="">
  <td class="nbLine">196</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    as the contents.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">197</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">198</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">199</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def __init__(self, script):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">200</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        braillegenerator.BrailleGenerator.__init__(self, script)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">201</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">202</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def _getBrailleRegionsForTableCellRow(self, obj):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">203</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Get the braille for a table cell row or a single table cell</pre></td>
</tr>
<tr class="">
  <td class="nbLine">204</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        if settings.readTableCellRow is False.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">205</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">206</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">207</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - obj: the table cell</pre></td>
</tr>
<tr class="">
  <td class="nbLine">208</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">209</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Returns a list where the first element is a list of Regions to display</pre></td>
</tr>
<tr class="">
  <td class="nbLine">210</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        and the second element is the Region which should get focus.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">211</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">212</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">213</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        global dynamicColumnHeaders, dynamicRowHeaders</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">214</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        global getColumnHeaderCell, getRowHeaderCell, isSpreadSheetCell</pre></td>
</tr>
<tr class="">
  <td class="nbLine">215</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">216</td>
  <td class="nbHits">11</td>
  <td class="src"><pre>        regions = []</pre></td>
</tr>
<tr class="">
  <td class="nbLine">217</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">218</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Check to see if this spread sheet cell has either a dynamic</pre></td>
</tr>
<tr class="">
  <td class="nbLine">219</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # column heading or row heading (or both) associated with it.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">220</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # If it does, then braille those first before brailling the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">221</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # cell contents.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">222</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">223</td>
  <td class="nbHits">11</td>
  <td class="src"><pre>        table = getTable(obj)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">224</td>
  <td class="nbHits">11</td>
  <td class="src"><pre>        parent = obj.parent</pre></td>
</tr>
<tr class="">
  <td class="nbLine">225</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">226</td>
  <td class="nbHits">11</td>
  <td class="src"><pre>        if parent.__dict__.has_key("lastColumn") and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">227</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           parent.lastColumn != parent.table.getColumnAtIndex(obj.index):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">228</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if dynamicColumnHeaders.has_key(table):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">229</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                row = dynamicColumnHeaders[table]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">230</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                header = getDynamicRowHeaderCell(obj, row)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">231</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if header.childCount &gt; 0:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">232</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    for i in range(0, header.childCount):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">233</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        child = header.child(i)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">234</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        text = self._script.getText(child, 0, -1)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">235</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        if text:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">236</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            regions.append(braille.Region(" " + text + " "))</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">237</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                elif header.text:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">238</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    text = self._script.getText(header, 0, -1)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">239</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    if text:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">240</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        regions.append(braille.Region(" " + text + " "))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">241</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">242</td>
  <td class="nbHits">11</td>
  <td class="src"><pre>        if parent.__dict__.has_key("lastRow") and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">243</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           parent.lastRow != parent.table.getRowAtIndex(obj.index):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">244</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if dynamicRowHeaders.has_key(table):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">245</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                column = dynamicRowHeaders[table]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">246</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                header = getDynamicColumnHeaderCell(obj, column)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">247</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if header.childCount &gt; 0:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">248</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    for i in range(0, header.childCount):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">249</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        child = header.child(i)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">250</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        text = self._script.getText(child, 0, -1)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">251</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        if text:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">252</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            regions.append(braille.Region(" " + text + " "))</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">253</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                elif header.text:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">254</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    text = self._script.getText(header, 0, -1)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">255</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    if text:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">256</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        regions.append(braille.Region(" " + text + " "))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">257</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">258</td>
  <td class="nbHits">11</td>
  <td class="src"><pre>        if isSpreadSheetCell(obj):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">259</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">260</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # Adding in a check here to make sure that the parent is a</pre></td>
</tr>
<tr class="">
  <td class="nbLine">261</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # valid table. It's possible that the parent could be a</pre></td>
</tr>
<tr class="">
  <td class="nbLine">262</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # table cell too (see bug #351501).</pre></td>
</tr>
<tr class="">
  <td class="nbLine">263</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">264</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if settings.readTableCellRow and obj.parent.table:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">265</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                rowRegions = []</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">266</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                savedBrailleVerbosityLevel = settings.brailleVerbosityLevel</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">267</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                settings.brailleVerbosityLevel = \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">268</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                                             settings.VERBOSITY_LEVEL_BRIEF</pre></td>
</tr>
<tr class="">
  <td class="nbLine">269</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">270</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                parent = obj.parent</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">271</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                row = parent.table.getRowAtIndex(obj.index)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">272</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                column = parent.table.getColumnAtIndex(obj.index)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">273</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">274</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                # This is an indication of whether we should speak all the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">275</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                # table cells (the user has moved focus up or down a row),</pre></td>
</tr>
<tr class="">
  <td class="nbLine">276</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                # or just the current one (focus has moved left or right in</pre></td>
</tr>
<tr class="">
  <td class="nbLine">277</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                # the same row).</pre></td>
</tr>
<tr class="">
  <td class="nbLine">278</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">279</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                speakAll = True</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">280</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if parent.__dict__.has_key("lastRow") and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">281</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                    parent.__dict__.has_key("lastColumn"):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">282</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    speakAll = (parent.lastRow != row) or \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">283</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                           ((row == 0 or row == parent.table.nRows-1) and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">284</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                            parent.lastColumn == column)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">285</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">286</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if speakAll:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">287</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    focusRowRegion = None</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">288</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    for i in range(0, parent.table.nColumns):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">289</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        accRow = parent.table.getAccessibleAt(row, i)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">290</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        cell = atspi.Accessible.makeAccessible(accRow)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">291</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        showing = cell.state.count( \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">292</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                                        atspi.Accessibility.STATE_SHOWING)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">293</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        if showing:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">294</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            [cellRegions, focusRegion] = \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">295</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                                self._getBrailleRegionsForTableCell(cell)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">296</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            if len(rowRegions):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">297</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                rowRegions.append(braille.Region(" "))</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">298</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            rowRegions.append(cellRegions[0])</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">299</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            if i == column:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">300</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                focusRowRegion = cellRegions[0]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">301</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    regions.extend(rowRegions)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">302</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    settings.brailleVerbosityLevel = savedBrailleVerbosityLevel</pre></td>
</tr>
<tr class="">
  <td class="nbLine">303</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">304</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    [cellRegions, focusRegion] = \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">305</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                                self._getBrailleRegionsForTableCell(obj)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">306</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    regions.extend(cellRegions)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">307</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">308</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                [cellRegions, focusRegion] = \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">309</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                                self._getBrailleRegionsForTableCell(obj)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">310</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                regions.extend(cellRegions)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">311</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            regions = [regions, focusRegion]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">312</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">313</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            brailleGen = braillegenerator.BrailleGenerator</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">314</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            [cellRegions, focusRegion] = \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">315</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                brailleGen._getBrailleRegionsForTableCellRow(self, obj)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">316</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            regions.extend(cellRegions)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">317</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            regions = [regions, focusRegion]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">318</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">319</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        return regions</pre></td>
</tr>
<tr class="">
  <td class="nbLine">320</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">321</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def _getBrailleRegionsForTableCell(self, obj):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">322</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Get the braille for a table cell. If this isn't inside a</pre></td>
</tr>
<tr class="">
  <td class="nbLine">323</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        spread sheet, just return the regions returned by the default</pre></td>
</tr>
<tr class="">
  <td class="nbLine">324</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        table cell braille handler.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">325</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">326</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">327</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - obj: the table cell</pre></td>
</tr>
<tr class="">
  <td class="nbLine">328</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">329</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Returns a list where the first element is a list of Regions to display</pre></td>
</tr>
<tr class="">
  <td class="nbLine">330</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        and the second element is the Region which should get focus.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">331</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">332</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">333</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        global inputLineForCell, isSpreadSheetCell, locateInputLine</pre></td>
</tr>
<tr class="">
  <td class="nbLine">334</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">335</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if isSpreadSheetCell(obj):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">336</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if inputLineForCell == None:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">337</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                inputLineForCell = locateInputLine(obj)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">338</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">339</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            regions = []</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">340</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            text = self.getDisplayedText(obj)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">341</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            componentRegion = braille.Component(obj, text)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">342</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            regions.append(componentRegion)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">343</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">344</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # If the spread sheet table cell has something in it, then we</pre></td>
</tr>
<tr class="">
  <td class="nbLine">345</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # want to append the name of the cell (which will be its location).</pre></td>
</tr>
<tr class="">
  <td class="nbLine">346</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # Note that if the cell was empty, then self.getDisplayedText will</pre></td>
</tr>
<tr class="">
  <td class="nbLine">347</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # have already done this for us.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">348</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">349</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if obj.text:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">350</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                objectText = self._script.getText(obj, 0, -1)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">351</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if objectText and len(objectText) != 0:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">352</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    regions.append(braille.Region(" " + obj.name))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">353</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">354</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return [regions, componentRegion]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">355</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">356</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        else:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">357</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # Check to see how many children this table cell has. If it's</pre></td>
</tr>
<tr class="">
  <td class="nbLine">358</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # just one (or none), then pass it on to the superclass to be</pre></td>
</tr>
<tr class="">
  <td class="nbLine">359</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # processed.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">360</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">361</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # If it's more than one, then get the braille regions for each </pre></td>
</tr>
<tr class="">
  <td class="nbLine">362</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # child, and call this method again.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">363</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">364</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if obj.childCount &lt;= 1:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">365</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                brailleGen = braillegenerator.BrailleGenerator</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">366</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                regions = brailleGen._getBrailleRegionsForTableCell(self, obj)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">367</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">368</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                regions = []</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">369</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                for i in range(0, obj.childCount):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">370</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    child = obj.child(i)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">371</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    [cellRegions, focusRegion] = \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">372</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                                self._getBrailleRegionsForTableCell(child)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">373</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    regions.extend(cellRegions)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">374</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                return [regions, focusRegion]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">375</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">376</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        return regions</pre></td>
</tr>
<tr class="">
  <td class="nbLine">377</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">378</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>class SpeechGenerator(speechgenerator.SpeechGenerator):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">379</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    """Overrides _getSpeechForComboBox so that we can provide a name for</pre></td>
</tr>
<tr class="">
  <td class="nbLine">380</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    the Calc Name combo box.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">381</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    Overrides _getSpeechForTableCellRow so that , when we are in a</pre></td>
</tr>
<tr class="">
  <td class="nbLine">382</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    spread sheet, we can speak the dynamic row and column headers</pre></td>
</tr>
<tr class="">
  <td class="nbLine">383</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    (assuming they are set).</pre></td>
</tr>
<tr class="">
  <td class="nbLine">384</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    Overrides _getSpeechForTableCell so that, when we are in a spread</pre></td>
</tr>
<tr class="">
  <td class="nbLine">385</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    sheet, we can speak the location of the table cell as well as the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">386</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    contents.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">387</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    Overrides _getSpeechForToggleButton so that, when the toggle buttons</pre></td>
</tr>
<tr class="">
  <td class="nbLine">388</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    on the Formatting toolbar change state, we provide both the name and</pre></td>
</tr>
<tr class="">
  <td class="nbLine">389</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    the state (as "on" or "off")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">390</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    Overrides _getSpeechForPushButton because sometimes the toggle buttons</pre></td>
</tr>
<tr class="">
  <td class="nbLine">391</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    on the Formatting toolbar claim to be push buttons.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">392</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">393</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def __init__(self, script):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">394</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        speechgenerator.SpeechGenerator.__init__(self, script)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">395</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">396</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def _getSpeechForComboBox(self, obj, already_focused):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">397</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Get the speech for a combo box. If the combo box already has focus,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">398</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        then only the selection is spoken.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">399</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Also provides a name for the OOo Calc Name combo box. This name is</pre></td>
</tr>
<tr class="">
  <td class="nbLine">400</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        provided in clause 5) of locusOfFocusChanged() below.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">401</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">402</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">403</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - obj: the combo box</pre></td>
</tr>
<tr class="">
  <td class="nbLine">404</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - already_focused: False if object just received focus</pre></td>
</tr>
<tr class="">
  <td class="nbLine">405</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">406</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Returns a list of utterances to be spoken for the object.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">407</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">408</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">409</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>        utterances = []</pre></td>
</tr>
<tr class="">
  <td class="nbLine">410</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">411</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>        if not already_focused:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">412</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>            label = self._getSpeechForObjectLabel(obj)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">413</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>            if not label:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">414</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>                label = [ obj.name ]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">415</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>            utterances.extend(label)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">416</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">417</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            label = None</pre></td>
</tr>
<tr class="">
  <td class="nbLine">418</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">419</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>        name = self._getSpeechForObjectName(obj)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">420</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>        if name != label:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">421</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            utterances.extend(name)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">422</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">423</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>        if not already_focused:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">424</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>            utterances.extend(self._getSpeechForObjectRole(obj))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">425</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">426</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>        utterances.extend(self._getSpeechForObjectAvailability(obj))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">427</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">428</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>        self._debugGenerator("_getSpeechForComboBox",</pre></td>
</tr>
<tr class="">
  <td class="nbLine">429</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>                             obj,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">430</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>                             already_focused,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">431</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>                             utterances)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">432</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">433</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>        return utterances</pre></td>
</tr>
<tr class="">
  <td class="nbLine">434</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">435</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def _getSpeechForTableCellRow(self, obj, already_focused):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">436</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Get the speech for a table cell row or a single table cell</pre></td>
</tr>
<tr class="">
  <td class="nbLine">437</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        if settings.readTableCellRow is False. If this isn't inside a</pre></td>
</tr>
<tr class="">
  <td class="nbLine">438</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        spread sheet, just return the utterances returned by the default</pre></td>
</tr>
<tr class="">
  <td class="nbLine">439</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        table cell speech handler.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">440</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">441</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">442</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - obj: the table cell</pre></td>
</tr>
<tr class="">
  <td class="nbLine">443</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - already_focused: False if object just received focus</pre></td>
</tr>
<tr class="">
  <td class="nbLine">444</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">445</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Returns a list of utterances to be spoken for the object.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">446</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">447</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">448</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        global dynamicColumnHeaders, dynamicRowHeaders</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">449</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        global getColumnHeaderCell, getRowHeaderCell, isSpreadSheetCell</pre></td>
</tr>
<tr class="">
  <td class="nbLine">450</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">451</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        utterances = []</pre></td>
</tr>
<tr class="">
  <td class="nbLine">452</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">453</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if not already_focused:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">454</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">455</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # Check to see if this spread sheet cell has either a dynamic</pre></td>
</tr>
<tr class="">
  <td class="nbLine">456</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # column heading or row heading (or both) associated with it.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">457</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # If it does, then speak those first before speaking the cell</pre></td>
</tr>
<tr class="">
  <td class="nbLine">458</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # contents.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">459</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">460</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            table = getTable(obj)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">461</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            parent = obj.parent</pre></td>
</tr>
<tr class="">
  <td class="nbLine">462</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">463</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if parent.__dict__.has_key("lastColumn") and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">464</td>
  <td class="nbHits"></td>
  <td class="src"><pre>               parent.lastColumn != \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">465</td>
  <td class="nbHits"></td>
  <td class="src"><pre>               parent.table.getColumnAtIndex(obj.index):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">466</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if dynamicColumnHeaders.has_key(table):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">467</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    row = dynamicColumnHeaders[table]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">468</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    header = getDynamicRowHeaderCell(obj, row)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">469</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    if header.childCount &gt; 0:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">470</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        for i in range(0, header.childCount):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">471</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            child = header.child(i)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">472</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            text = self._script.getText(child, 0, -1)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">473</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            if text:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">474</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                utterances.append(text)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">475</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    elif header.text:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">476</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        text = self._script.getText(header, 0, -1)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">477</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        if text:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">478</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            utterances.append(text)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">479</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">480</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if parent.__dict__.has_key("lastRow") and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">481</td>
  <td class="nbHits"></td>
  <td class="src"><pre>               parent.lastRow != parent.table.getRowAtIndex(obj.index):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">482</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if dynamicRowHeaders.has_key(table):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">483</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    column = dynamicRowHeaders[table]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">484</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    header = getDynamicColumnHeaderCell(obj, column)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">485</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    if header.childCount &gt; 0:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">486</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        for i in range(0, header.childCount):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">487</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            child = header.child(i)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">488</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            text = self._script.getText(child, 0, -1)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">489</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            if text:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">490</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                utterances.append(text)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">491</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    elif header.text:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">492</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        text = self._script.getText(header, 0, -1)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">493</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        if text:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">494</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            utterances.append(text)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">495</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">496</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if isSpreadSheetCell(obj):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">497</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if not already_focused:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">498</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if settings.readTableCellRow:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">499</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    parent = obj.parent</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">500</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    row = parent.table.getRowAtIndex(obj.index)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">501</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    column = parent.table.getColumnAtIndex(obj.index)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">502</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">503</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                    # This is an indication of whether we should speak all the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">504</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                    # table cells (the user has moved focus up or down a row),</pre></td>
</tr>
<tr class="">
  <td class="nbLine">505</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                    # or just the current one (focus has moved left or right in</pre></td>
</tr>
<tr class="">
  <td class="nbLine">506</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                    # the same row).</pre></td>
</tr>
<tr class="">
  <td class="nbLine">507</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                    #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">508</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    speakAll = True</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">509</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    if parent.__dict__.has_key("lastRow") and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">510</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                        parent.__dict__.has_key("lastColumn"):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">511</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        speakAll = (parent.lastRow != row) or \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">512</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                               ((row == 0 or row == parent.table.nRows-1) and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">513</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                                parent.lastColumn == column)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">514</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">515</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    if speakAll:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">516</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        for i in range(0, parent.table.nColumns):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">517</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            accRow = parent.table.getAccessibleAt(row, i)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">518</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            cell = atspi.Accessible.makeAccessible(accRow)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">519</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            showing = cell.state.count( \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">520</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                                          atspi.Accessibility.STATE_SHOWING)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">521</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            if showing:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">522</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                utterances.extend(self._getSpeechForTableCell(\</pre></td>
</tr>
<tr class="">
  <td class="nbLine">523</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                                                  cell, already_focused))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">524</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                    else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">525</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        utterances.extend(self._getSpeechForTableCell(obj,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">526</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                                             already_focused))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">527</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">528</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    utterances.extend(self._getSpeechForTableCell(obj,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">529</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                                             already_focused))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">530</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">531</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            speechGen = speechgenerator.SpeechGenerator</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">532</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            utterances.extend(speechGen._getSpeechForTableCellRow(self, obj,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">533</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                                             already_focused))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">534</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">535</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        return utterances</pre></td>
</tr>
<tr class="">
  <td class="nbLine">536</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">537</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def _getSpeechForTableCell(self, obj, already_focused):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">538</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Get the speech for a table cell. If this isn't inside a</pre></td>
</tr>
<tr class="">
  <td class="nbLine">539</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        spread sheet, just return the utterances returned by the default</pre></td>
</tr>
<tr class="">
  <td class="nbLine">540</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        table cell speech handler.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">541</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">542</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">543</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - obj: the table cell</pre></td>
</tr>
<tr class="">
  <td class="nbLine">544</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - already_focused: False if object just received focus</pre></td>
</tr>
<tr class="">
  <td class="nbLine">545</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">546</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Returns a list of utterances to be spoken for the object.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">547</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">548</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">549</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        global inputLineForCell, isSpreadSheetCell, locateInputLine</pre></td>
</tr>
<tr class="">
  <td class="nbLine">550</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">551</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if isSpreadSheetCell(obj):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">552</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            utterances = []</pre></td>
</tr>
<tr class="">
  <td class="nbLine">553</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">554</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if inputLineForCell == None:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">555</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                inputLineForCell = locateInputLine(obj)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">556</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">557</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if obj.text:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">558</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                objectText = self._script.getText(obj, 0, -1)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">559</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                utterances.append(objectText)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">560</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">561</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            nameList = obj.name.split()</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">562</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            utterances.append(nameList[1])</pre></td>
</tr>
<tr class="">
  <td class="nbLine">563</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        else:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">564</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # Check to see how many children this table cell has. If it's</pre></td>
</tr>
<tr class="">
  <td class="nbLine">565</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # just one (or none), then pass it on to the superclass to be </pre></td>
</tr>
<tr class="">
  <td class="nbLine">566</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # processed.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">567</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">568</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # If it's more than one, then get the speech for each child,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">569</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # and call this method again.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">570</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">571</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if obj.childCount &lt;= 1:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">572</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                speechGen = speechgenerator.SpeechGenerator</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">573</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                utterances = speechGen._getSpeechForTableCell(self, obj,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">574</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                                        already_focused)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">575</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">576</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                utterances = []</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">577</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                for i in range(0, obj.childCount):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">578</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    child = obj.child(i)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">579</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    utterances.extend(self._getSpeechForTableCell(child,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">580</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                                        already_focused))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">581</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">582</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        return utterances</pre></td>
</tr>
<tr class="">
  <td class="nbLine">583</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">584</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def _getSpeechForToggleButton(self, obj, already_focused):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">585</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Get the speech for a toggle button.  We always want to speak the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">586</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        state if it's on a toolbar.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">587</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">588</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">589</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - obj: the toggle button</pre></td>
</tr>
<tr class="">
  <td class="nbLine">590</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - already_focused: False if object just received focus</pre></td>
</tr>
<tr class="">
  <td class="nbLine">591</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">592</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Returns a list of utterances to be spoken for the object.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">593</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">594</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">595</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        utterances = []</pre></td>
</tr>
<tr class="">
  <td class="nbLine">596</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        if obj.parent.role == rolenames.ROLE_TOOL_BAR:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">597</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if obj.state.count(atspi.Accessibility.STATE_CHECKED):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">598</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                checkedState = _("on")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">599</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">600</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                checkedState = _("off")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">601</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">602</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            utterances.append(obj.name)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">603</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            utterances.append(checkedState)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">604</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        else:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">605</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>            speechGen = speechgenerator.SpeechGenerator</pre></td>
</tr>
<tr class="">
  <td class="nbLine">606</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>            utterances.extend(speechGen._getSpeechForToggleButton(self, obj,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">607</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>                                                             already_focused))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">608</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">609</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        return utterances</pre></td>
</tr>
<tr class="">
  <td class="nbLine">610</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">611</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def _getSpeechForPushButton(self, obj, already_focused):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">612</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Get the speech for a push button.  We always want to speak the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">613</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        state if it's on a toolbar.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">614</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">615</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">616</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - obj: the push button</pre></td>
</tr>
<tr class="">
  <td class="nbLine">617</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - already_focused: False if object just received focus</pre></td>
</tr>
<tr class="">
  <td class="nbLine">618</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">619</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Returns a list of utterances to be spoken for the object.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">620</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">621</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">622</td>
  <td class="nbHits">8</td>
  <td class="src"><pre>        utterances = []</pre></td>
</tr>
<tr class="">
  <td class="nbLine">623</td>
  <td class="nbHits">8</td>
  <td class="src"><pre>        if obj.parent.role == rolenames.ROLE_TOOL_BAR:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">624</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if obj.state.count(atspi.Accessibility.STATE_CHECKED):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">625</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                checkedState = _("on")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">626</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">627</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                checkedState = _("off")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">628</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">629</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            utterances.append(obj.name)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">630</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            utterances.append(checkedState)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">631</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        else:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">632</td>
  <td class="nbHits">8</td>
  <td class="src"><pre>            speechGen = speechgenerator.SpeechGenerator</pre></td>
</tr>
<tr class="">
  <td class="nbLine">633</td>
  <td class="nbHits">8</td>
  <td class="src"><pre>            utterances.extend(speechGen._getSpeechForPushButton(self, obj,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">634</td>
  <td class="nbHits">8</td>
  <td class="src"><pre>                                                             already_focused))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">635</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">636</td>
  <td class="nbHits">8</td>
  <td class="src"><pre>        return utterances</pre></td>
</tr>
<tr class="">
  <td class="nbLine">637</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">638</td>
  <td class="nbHits"></td>
  <td class="src"><pre>########################################################################</pre></td>
</tr>
<tr class="">
  <td class="nbLine">639</td>
  <td class="nbHits"></td>
  <td class="src"><pre>#                                                                      #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">640</td>
  <td class="nbHits"></td>
  <td class="src"><pre># The StarOffice script class.                                         #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">641</td>
  <td class="nbHits"></td>
  <td class="src"><pre>#                                                                      #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">642</td>
  <td class="nbHits"></td>
  <td class="src"><pre>########################################################################</pre></td>
</tr>
<tr class="">
  <td class="nbLine">643</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">644</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>class Script(default.Script):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">645</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">646</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def __init__(self, app):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">647</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Creates a new script for the given application.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">648</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">649</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">650</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - app: the application to create a script for.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">651</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">652</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">653</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        default.Script.__init__(self, app)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">654</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">655</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Set the debug level for all the methods in this script.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">656</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">657</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        self.debugLevel = debug.LEVEL_FINEST</pre></td>
</tr>
<tr class="">
  <td class="nbLine">658</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">659</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # A handle to the last spread sheet cell encountered.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">660</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">661</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        self.lastCell = None</pre></td>
</tr>
<tr class="">
  <td class="nbLine">662</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">663</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # The following variables will be used to try to determine if we've</pre></td>
</tr>
<tr class="">
  <td class="nbLine">664</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # already handled this misspelt word (see readMisspeltWord() for</pre></td>
</tr>
<tr class="">
  <td class="nbLine">665</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # more details.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">666</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">667</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        self.lastTextLength = -1</pre></td>
</tr>
<tr class="">
  <td class="nbLine">668</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        self.lastBadWord = ''</pre></td>
</tr>
<tr class="">
  <td class="nbLine">669</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        self.lastStartOff = -1</pre></td>
</tr>
<tr class="">
  <td class="nbLine">670</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        self.lastEndOff = -1</pre></td>
</tr>
<tr class="">
  <td class="nbLine">671</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">672</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Used to determine if the user has double-clicked the dynamic</pre></td>
</tr>
<tr class="">
  <td class="nbLine">673</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # row/column hotkeys.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">674</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">675</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        self.lastDynamicEvent = None</pre></td>
</tr>
<tr class="">
  <td class="nbLine">676</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">677</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Used to determine whether the caret has moved to a new paragraph.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">678</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">679</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        self.currentParagraph = None</pre></td>
</tr>
<tr class="">
  <td class="nbLine">680</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">681</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Set the number of retries after a COMM_FAILURE to 1. The default</pre></td>
</tr>
<tr class="">
  <td class="nbLine">682</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # of 5 was not allowing Orca to be responsive in the event of OOo</pre></td>
</tr>
<tr class="">
  <td class="nbLine">683</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # going into crash recovery mode (see bug #397787).</pre></td>
</tr>
<tr class="">
  <td class="nbLine">684</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">685</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        self.commFailureAttemptLimit = 1</pre></td>
</tr>
<tr class="">
  <td class="nbLine">686</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">687</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # The default set of text attributes to speak to the user. The</pre></td>
</tr>
<tr class="">
  <td class="nbLine">688</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # only difference over the default set in settings.py is to add</pre></td>
</tr>
<tr class="">
  <td class="nbLine">689</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # in "left-margin:" and "right-margin:".</pre></td>
</tr>
<tr class="">
  <td class="nbLine">690</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">691</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        settings.enabledTextAttributes = "size:; family-name:; weight:400; indent:0; left-margin:0; right-margin:0; underline:none; strikethrough:false; justification:left; style:normal;"</pre></td>
</tr>
<tr class="">
  <td class="nbLine">692</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">693</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # [[[TODO: JD - HACK because we won't get events from toggle</pre></td>
</tr>
<tr class="">
  <td class="nbLine">694</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # buttons on the Formatting toolbar until we "tickle/poke"</pre></td>
</tr>
<tr class="">
  <td class="nbLine">695</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # the hierarchy. But we only want to do it once.  </pre></td>
</tr>
<tr class="">
  <td class="nbLine">696</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # See bug #363830 and OOo issue #70872.]]]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">697</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">698</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        self.tickled = None</pre></td>
</tr>
<tr class="">
  <td class="nbLine">699</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">700</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def getBrailleGenerator(self):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">701</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Returns the braille generator for this script.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">702</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">703</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">704</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        return BrailleGenerator(self)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">705</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">706</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def getSpeechGenerator(self):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">707</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Returns the speech generator for this script.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">708</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">709</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">710</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        return SpeechGenerator(self)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">711</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">712</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def setupInputEventHandlers(self):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">713</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Defines InputEventHandler fields for this script that can be</pre></td>
</tr>
<tr class="">
  <td class="nbLine">714</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        called by the key and braille bindings. In this particular case,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">715</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        we just want to be able to add a handler to return the contents of</pre></td>
</tr>
<tr class="">
  <td class="nbLine">716</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        the input line.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">717</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">718</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">719</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        default.Script.setupInputEventHandlers(self)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">720</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">721</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        self.inputEventHandlers["speakInputLineHandler"] = \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">722</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            input_event.InputEventHandler(</pre></td>
</tr>
<tr class="">
  <td class="nbLine">723</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                Script.speakInputLine,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">724</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>                _("Speaks the contents of the input line."))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">725</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">726</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        self.inputEventHandlers["setDynamicColumnHeadersHandler"] = \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">727</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            input_event.InputEventHandler(</pre></td>
</tr>
<tr class="">
  <td class="nbLine">728</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                Script.setDynamicColumnHeaders,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">729</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>                _("Set the row to use as dynamic column headers when speaking calc cells."))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">730</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">731</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        self.inputEventHandlers["setDynamicRowHeadersHandler"] = \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">732</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            input_event.InputEventHandler(</pre></td>
</tr>
<tr class="">
  <td class="nbLine">733</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                Script.setDynamicRowHeaders,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">734</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>                _("Set the column to use as dynamic row headers to use when speaking calc cells."))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">735</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">736</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def getKeyBindings(self):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">737</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Defines the key bindings for this script. Setup the default</pre></td>
</tr>
<tr class="">
  <td class="nbLine">738</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        key bindings, then add one in for reading the input line.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">739</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">740</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Returns an instance of keybindings.KeyBindings.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">741</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">742</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">743</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        keyBindings = default.Script.getKeyBindings(self)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">744</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">745</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        keyBindings.add(</pre></td>
</tr>
<tr class="">
  <td class="nbLine">746</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            keybindings.KeyBinding(</pre></td>
</tr>
<tr class="">
  <td class="nbLine">747</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                "a",</pre></td>
</tr>
<tr class="">
  <td class="nbLine">748</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>                1 &lt;&lt; settings.MODIFIER_ORCA,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">749</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>                1 &lt;&lt; settings.MODIFIER_ORCA,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">750</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>                self.inputEventHandlers["speakInputLineHandler"]))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">751</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">752</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        keyBindings.add(</pre></td>
</tr>
<tr class="">
  <td class="nbLine">753</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            keybindings.KeyBinding(</pre></td>
</tr>
<tr class="">
  <td class="nbLine">754</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                "r",</pre></td>
</tr>
<tr class="">
  <td class="nbLine">755</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>                1 &lt;&lt; settings.MODIFIER_ORCA,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">756</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>                1 &lt;&lt; settings.MODIFIER_ORCA,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">757</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>                self.inputEventHandlers["setDynamicColumnHeadersHandler"]))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">758</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">759</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        keyBindings.add(</pre></td>
</tr>
<tr class="">
  <td class="nbLine">760</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            keybindings.KeyBinding(</pre></td>
</tr>
<tr class="">
  <td class="nbLine">761</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                "c",</pre></td>
</tr>
<tr class="">
  <td class="nbLine">762</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>                1 &lt;&lt; settings.MODIFIER_ORCA,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">763</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>                1 &lt;&lt; settings.MODIFIER_ORCA,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">764</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>                self.inputEventHandlers["setDynamicRowHeadersHandler"]))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">765</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">766</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>        return keyBindings</pre></td>
</tr>
<tr class="">
  <td class="nbLine">767</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">768</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def checkForTableBoundry(self, oldFocus, newFocus):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">769</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Check to see if we've entered or left a table.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">770</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        When entering a table, announce the table dimensions.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">771</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        When leaving a table, announce that the table has been exited.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">772</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">773</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">774</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - oldFocus: Accessible that is the old locus of focus</pre></td>
</tr>
<tr class="">
  <td class="nbLine">775</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - newFocus: Accessible that is the new locus of focus</pre></td>
</tr>
<tr class="">
  <td class="nbLine">776</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">777</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">778</td>
  <td class="nbHits">47</td>
  <td class="src"><pre>        if oldFocus == None or newFocus == None:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">779</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return</pre></td>
</tr>
<tr class="">
  <td class="nbLine">780</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">781</td>
  <td class="nbHits">47</td>
  <td class="src"><pre>        oldFocusIsTable = None </pre></td>
</tr>
<tr class="">
  <td class="nbLine">782</td>
  <td class="nbHits">285</td>
  <td class="src"><pre>        while oldFocus.role != rolenames.ROLE_APPLICATION:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">783</td>
  <td class="nbHits">238</td>
  <td class="src"><pre>            if oldFocus.role == rolenames.ROLE_TABLE:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">784</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                oldFocusIsTable = oldFocus</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">785</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                break</pre></td>
</tr>
<tr class="">
  <td class="nbLine">786</td>
  <td class="nbHits">238</td>
  <td class="src"><pre>            oldFocus = oldFocus.parent </pre></td>
</tr>
<tr class="">
  <td class="nbLine">787</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">788</td>
  <td class="nbHits">47</td>
  <td class="src"><pre>        newFocusIsTable = None</pre></td>
</tr>
<tr class="">
  <td class="nbLine">789</td>
  <td class="nbHits">306</td>
  <td class="src"><pre>        while newFocus.role != rolenames.ROLE_APPLICATION:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">790</td>
  <td class="nbHits">259</td>
  <td class="src"><pre>            if newFocus.role == rolenames.ROLE_TABLE:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">791</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                newFocusIsTable = newFocus</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">792</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                break</pre></td>
</tr>
<tr class="">
  <td class="nbLine">793</td>
  <td class="nbHits">259</td>
  <td class="src"><pre>            newFocus = newFocus.parent</pre></td>
</tr>
<tr class="">
  <td class="nbLine">794</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">795</td>
  <td class="nbHits">47</td>
  <td class="src"><pre>        if oldFocusIsTable == None and newFocusIsTable != None:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">796</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            rows = newFocusIsTable.table.nRows</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">797</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            columns = newFocusIsTable.table.nColumns</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">798</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            line = _("table with %d rows and %d columns.") % (rows, columns)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">799</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            speech.speak(line)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">800</td>
  <td class="nbHits">47</td>
  <td class="src"><pre>        elif oldFocusIsTable != None and newFocusIsTable == None:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">801</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            speech.speak(_("leaving table."))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">802</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">803</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def speakInputLine(self, inputEvent):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">804</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Speak the contents of the spread sheet input line (assuming we</pre></td>
</tr>
<tr class="">
  <td class="nbLine">805</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        have a handle to it - generated when we first focus on a spread</pre></td>
</tr>
<tr class="">
  <td class="nbLine">806</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        sheet table cell.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">807</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">808</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        This will be either the contents of the table cell that has focus</pre></td>
</tr>
<tr class="">
  <td class="nbLine">809</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        or the formula associated with it.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">810</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">811</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">812</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - inputEvent: if not None, the input event that caused this action.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">813</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">814</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">815</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        debug.println(self.debugLevel, "StarOffice.speakInputLine.")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">816</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">817</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Check to see if the current focus is a table cell.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">818</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">819</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if isSpreadSheetCell(orca_state.locusOfFocus):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">820</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if inputLineForCell and inputLineForCell.text:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">821</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                inputLine = self.getText(inputLineForCell, 0, -1)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">822</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if not inputLine:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">823</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    inputLine = _("empty")</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">824</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                debug.println(self.debugLevel,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">825</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        "StarOffice.speakInputLine: contents: %s" % inputLine)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">826</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                speech.speak(inputLine)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">827</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">828</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def getTableRow(self, cell):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">829</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Get the row number in the table that this table cell is on.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">830</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">831</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">832</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - cell: the table cell to get the row number for.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">833</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">834</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Return the row number that this table cell is on, or None if</pre></td>
</tr>
<tr class="">
  <td class="nbLine">835</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        this isn't a table cell.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">836</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">837</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">838</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        row = None</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">839</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        cell = adjustForWriterTable(cell)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">840</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if cell.role == rolenames.ROLE_TABLE_CELL:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">841</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            parent = cell.parent</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">842</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if parent and parent.table:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">843</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                row = parent.table.getRowAtIndex(cell.index)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">844</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">845</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        return row</pre></td>
</tr>
<tr class="">
  <td class="nbLine">846</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">847</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def getTableColumn(self, cell):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">848</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Get the column number in the table that this table cell is on.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">849</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">850</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">851</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - cell: the table cell to get the column number for.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">852</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">853</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Return the column number that this table cell is on, or None if</pre></td>
</tr>
<tr class="">
  <td class="nbLine">854</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        this isn't a table cell.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">855</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">856</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">857</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        column = None</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">858</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        cell = adjustForWriterTable(cell)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">859</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if cell.role == rolenames.ROLE_TABLE_CELL:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">860</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            parent = cell.parent</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">861</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if parent and parent.table:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">862</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                column = parent.table.getColumnAtIndex(cell.index)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">863</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">864</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        return column</pre></td>
</tr>
<tr class="">
  <td class="nbLine">865</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">866</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def setDynamicColumnHeaders(self, inputEvent):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">867</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Set the row for the dynamic header columns to use when speaking</pre></td>
</tr>
<tr class="">
  <td class="nbLine">868</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        calc cell entries. In order to set the row, the user should first set</pre></td>
</tr>
<tr class="">
  <td class="nbLine">869</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        focus to the row that they wish to define and then press Insert-r.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">870</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">871</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Once the user has defined the row, it will be used to first speak</pre></td>
</tr>
<tr class="">
  <td class="nbLine">872</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        this header when moving between columns.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">873</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">874</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        A "double-click" of the Insert-c hotkey, will clear the dynamic</pre></td>
</tr>
<tr class="">
  <td class="nbLine">875</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        header column.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">876</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">877</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">878</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - inputEvent: if not None, the input event that caused this action.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">879</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">880</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">881</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        global dynamicColumnHeaders, getTable</pre></td>
</tr>
<tr class="">
  <td class="nbLine">882</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">883</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        debug.println(self.debugLevel, "StarOffice.setDynamicColumnHeaders.")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">884</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">885</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        clickCount = self.getClickCount(self.lastDynamicEvent, inputEvent)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">886</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        table = getTable(orca_state.locusOfFocus)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">887</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if table:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">888</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            row = self.getTableRow(orca_state.locusOfFocus)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">889</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if clickCount == 2:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">890</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                try:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">891</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    del dynamicColumnHeaders[table]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">892</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    line = _("Dynamic column header cleared.")</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">893</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    speech.speak(line)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">894</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    braille.displayMessage(line)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">895</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                except:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">896</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    pass</pre></td>
</tr>
<tr class="">
  <td class="nbLine">897</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">898</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                dynamicColumnHeaders[table] = row</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">899</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                line = _("Dynamic column header set for row ") + str(row+1)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">900</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                speech.speak(line)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">901</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                braille.displayMessage(line)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">902</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        self.lastDynamicEvent = inputEvent</pre></td>
</tr>
<tr class="">
  <td class="nbLine">903</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">904</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        return True</pre></td>
</tr>
<tr class="">
  <td class="nbLine">905</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">906</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def columnConvert(self, column):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">907</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """ Convert a spreadsheet column into it's column label</pre></td>
</tr>
<tr class="">
  <td class="nbLine">908</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">909</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">910</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - column: the column number to convert.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">911</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">912</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Returns a string representing the spread sheet column.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">913</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">914</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">915</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        BASE26="ABCDEFGHIJKLMNOPQRSTUVWXYZ"</pre></td>
</tr>
<tr class="">
  <td class="nbLine">916</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">917</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if column &lt;= len(BASE26):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">918</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return BASE26[column-1]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">919</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">920</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        res = ""</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">921</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        while column &gt; 0:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">922</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            digit = column % len(BASE26)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">923</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            res = " " + BASE26[digit-1] + res</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">924</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            column /= len(BASE26)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">925</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">926</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        return res</pre></td>
</tr>
<tr class="">
  <td class="nbLine">927</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">928</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def setDynamicRowHeaders(self, inputEvent):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">929</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Set the column for the dynamic header rows to use when speaking</pre></td>
</tr>
<tr class="">
  <td class="nbLine">930</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        calc cell entries. In order to set the column, the user should first</pre></td>
</tr>
<tr class="">
  <td class="nbLine">931</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        set focus to the column that they wish to define and then press</pre></td>
</tr>
<tr class="">
  <td class="nbLine">932</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Insert-c.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">933</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">934</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Once the user has defined the column, it will be used to first speak</pre></td>
</tr>
<tr class="">
  <td class="nbLine">935</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        this header when moving between rows.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">936</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">937</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        A "double-click" of the Insert-r hotkey, will clear the dynamic</pre></td>
</tr>
<tr class="">
  <td class="nbLine">938</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        header row.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">939</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">940</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">941</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - inputEvent: if not None, the input event that caused this action.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">942</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">943</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">944</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        global dynamicRowHeaders, getTable</pre></td>
</tr>
<tr class="">
  <td class="nbLine">945</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">946</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        debug.println(self.debugLevel, "StarOffice.setDynamicRowHeaders.")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">947</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">948</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        clickCount = self.getClickCount(self.lastDynamicEvent, inputEvent)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">949</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        table = getTable(orca_state.locusOfFocus)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">950</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if table:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">951</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            column = self.getTableColumn(orca_state.locusOfFocus)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">952</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if clickCount == 2:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">953</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                try:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">954</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    del dynamicRowHeaders[table]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">955</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    line = _("Dynamic row header cleared.")</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">956</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    speech.speak(line)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">957</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    braille.displayMessage(line)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">958</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                except:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">959</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    pass</pre></td>
</tr>
<tr class="">
  <td class="nbLine">960</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">961</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                dynamicRowHeaders[table] = column</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">962</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                line = _("Dynamic row header set for column %s") % \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">963</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                       self.columnConvert(column+1)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">964</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                speech.speak(line)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">965</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                braille.displayMessage(line)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">966</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">967</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        self.lastDynamicEvent = inputEvent</pre></td>
</tr>
<tr class="">
  <td class="nbLine">968</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">969</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        return True</pre></td>
</tr>
<tr class="">
  <td class="nbLine">970</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">971</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def readMisspeltWord(self, event, pane):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">972</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Speak/braille the current misspelt word plus its context.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">973</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           The spell check dialog contains a "paragraph" which shows the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">974</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           context for the current spelling mistake. After speaking/brailling</pre></td>
</tr>
<tr class="">
  <td class="nbLine">975</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           the default action for this component, that a selection of the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">976</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           surronding text from that paragraph with the misspelt word is also</pre></td>
</tr>
<tr class="">
  <td class="nbLine">977</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           spoken.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">978</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">979</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">980</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - event: the event.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">981</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - pane: the option pane in the spell check dialog.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">982</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">983</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">984</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        paragraph = self.findByRole(pane, rolenames.ROLE_PARAGRAPH)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">985</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">986</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Determine which word is the misspelt word. This word will have</pre></td>
</tr>
<tr class="">
  <td class="nbLine">987</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # non-default text attributes associated with it.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">988</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">989</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        textLength = paragraph[0].text.characterCount</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">990</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        startFound = False</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">991</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        startOff = 0</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">992</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        endOff = textLength</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">993</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        for i in range(0, textLength):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">994</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            attributes = paragraph[0].text.getAttributes(i)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">995</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if len(attributes[0]) != 0:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">996</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if not startFound:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">997</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    startOff = i</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">998</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    startFound = True</pre></td>
</tr>
<tr class="">
  <td class="nbLine">999</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1000</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if startFound:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1001</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    endOff = i</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1002</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    break</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1003</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1004</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        badWord = self.getText(paragraph[0], startOff, endOff - 1)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1005</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1006</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Note that we often get two or more of these focus or property-change</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1007</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # events each time there is a new misspelt word. We extract the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1008</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # length of the line of text, the misspelt word, the start and end</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1009</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # offsets for that word and compare them against the values saved</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1010</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # from the last time this routine was called. If they are the same</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1011</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # then we ignore it.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1012</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1013</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        debug.println(self.debugLevel, \</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1014</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            "StarOffice.readMisspeltWord: type=%s  word=%s(%d,%d)  len=%d" % \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1015</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            (event.type, badWord, startOff, endOff, textLength))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1016</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1017</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if (textLength == self.lastTextLength) and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1018</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           (badWord == self.lastBadWord) and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1019</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           (startOff == self.lastStartOff) and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1020</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           (endOff == self.lastEndOff):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1021</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1022</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1023</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Create a list of all the words found in the misspelt paragraph.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1024</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1025</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        text = self.getText(paragraph[0], 0, -1)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1026</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        allTokens = text.split()</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1027</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1028</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        self.speakMisspeltWord(allTokens, badWord)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1029</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1030</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Save misspelt word information for comparison purposes next</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1031</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # time around.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1032</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1033</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        self.lastTextLength = textLength</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1034</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        self.lastBadWord = badWord</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1035</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        self.lastStartOff = startOff</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1036</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        self.lastEndOff = endOff</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1037</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1038</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def endOfLink(self, obj, word, startOffset, endOffset):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1039</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Return an indication of whether the given word contains the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1040</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           end of a hypertext link.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1041</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1042</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1043</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - obj: an Accessible object that implements the AccessibleText</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1044</td>
  <td class="nbHits"></td>
  <td class="src"><pre>               interface</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1045</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - word: the word to check</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1046</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - startOffset: the start offset for this word</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1047</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - endOffset: the end offset for this word</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1048</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1049</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Returns True if this word contains the end of a hypertext link.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1050</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1051</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1052</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        nLinks = obj.hypertext.getNLinks()</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1053</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        links = []</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1054</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        for i in range(0, nLinks):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1055</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            links.append(obj.hypertext.getLink(i))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1056</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1057</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        for i in range(0, len(links)):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1058</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if links[i].endIndex &gt; startOffset and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1059</td>
  <td class="nbHits"></td>
  <td class="src"><pre>               links[i].endIndex &lt;= endOffset:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1060</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                return True</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1061</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1062</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        return False</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1063</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1064</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def sayWriterWord(self, obj, word, startOffset, endOffset):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1065</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Speaks the given word in the appropriate voice. If this word is</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1066</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        a hypertext link and it is also at the end offset for one of the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1067</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        links, then the word "link" is also spoken.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1068</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1069</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1070</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - obj: an Accessible object that implements the AccessibleText</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1071</td>
  <td class="nbHits"></td>
  <td class="src"><pre>               interface</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1072</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - word: the word to speak</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1073</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - startOffset: the start offset for this word</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1074</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - endOffset: the end offset for this word</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1075</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1076</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1077</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        voices = settings.voices</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1078</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1079</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        for i in range(startOffset, endOffset):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1080</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if self.getLinkIndex(obj, i) &gt;= 0:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1081</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                voice = voices[settings.HYPERLINK_VOICE]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1082</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                break</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1083</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            elif word.isupper():</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1084</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                voice = voices[settings.UPPERCASE_VOICE]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1085</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1086</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                voice = voices[settings.DEFAULT_VOICE]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1087</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1088</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        speech.speak(word, voice)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1089</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if self.endOfLink(obj, word, startOffset, endOffset):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1090</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            speech.speak(_("link"))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1091</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1092</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def isSetupDialog(self, obj):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1093</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """ Check to see if this object is in the Setup dialog by walking</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1094</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        back up the object hierarchy until we get to the dialog object and</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1095</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        checking to see if it has a name that starts with "Welcome to</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1096</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        StarOffice".</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1097</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1098</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1099</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - obj: an Accessible object that implements the AccessibleText</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1100</td>
  <td class="nbHits"></td>
  <td class="src"><pre>               interface</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1101</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1102</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Returns an indication of whether this object is in the Setup dialog.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1103</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1104</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1105</td>
  <td class="nbHits">138</td>
  <td class="src"><pre>        found = False</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1106</td>
  <td class="nbHits">846</td>
  <td class="src"><pre>        while obj and obj.role != rolenames.ROLE_APPLICATION:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1107</td>
  <td class="nbHits">708</td>
  <td class="src"><pre>            if obj.role == rolenames.ROLE_DIALOG and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1108</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                (obj.name and obj.name.startswith(_("Welcome to StarOffice"))):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1109</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                debug.println(self.debugLevel,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1110</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                              "StarOffice.isSetupDialog: True.")</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1111</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                found = True</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1112</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1113</td>
  <td class="nbHits">708</td>
  <td class="src"><pre>            obj = obj.parent</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1114</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1115</td>
  <td class="nbHits">138</td>
  <td class="src"><pre>        return found</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1116</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1117</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def speakSetupLabel(self, label):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1118</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Speak this Setup dialog label.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1119</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1120</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1121</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - label: the Setup dialog Label.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1122</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1123</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1124</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        text = self.getDisplayedText(label)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1125</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        if text:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1126</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            speech.speak(text)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1127</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1128</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def handleSetupPanel(self, panel):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1129</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Find all the labels in this Setup panel and speak them.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1130</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1131</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1132</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - panel: the Setup panel.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1133</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1134</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1135</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        allLabels = self.findByRole(panel, rolenames.ROLE_LABEL)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1136</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        for i in range(0, len(allLabels)):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1137</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.speakSetupLabel(allLabels[i])</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1138</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1139</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    # This method tries to detect and handle the following cases:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1140</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    # 0) Writer: find command.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1141</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    # 1) Writer: text paragraph.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1142</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    # 2) Writer: spell checking dialog.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1143</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    # 3) Welcome to StarOffice dialog.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1144</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    # 4) Calc: cell editor.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1145</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    # 5) Calc: name box.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1146</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1147</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def locusOfFocusChanged(self, event, oldLocusOfFocus, newLocusOfFocus):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1148</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Called when the visual object with focus changes.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1149</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1150</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1151</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - event: if not None, the Event that caused the change</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1152</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - oldLocusOfFocus: Accessible that is the old locus of focus</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1153</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - newLocusOfFocus: Accessible that is the new locus of focus</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1154</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1155</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1156</td>
  <td class="nbHits">133</td>
  <td class="src"><pre>        brailleGen = self.brailleGenerator</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1157</td>
  <td class="nbHits">133</td>
  <td class="src"><pre>        speechGen = self.speechGenerator</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1158</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1159</td>
  <td class="nbHits">133</td>
  <td class="src"><pre>        debug.printObjectEvent(self.debugLevel,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1160</td>
  <td class="nbHits">133</td>
  <td class="src"><pre>                               event,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1161</td>
  <td class="nbHits">133</td>
  <td class="src"><pre>                               event.source.toString())</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1162</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1163</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # self.printAncestry(event.source)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1164</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1165</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # 0) Writer: find command</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1166</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1167</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Check to see if this is this is for the find command. See </pre></td>
</tr>
<tr class="">
  <td class="nbLine">1168</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # comment #18 of bug #354463.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1169</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1170</td>
  <td class="nbHits">133</td>
  <td class="src"><pre>        if self.findCommandRun and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1171</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           event.type == "object:state-changed:focused":</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1172</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.findCommandRun = False</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1173</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.find()</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1174</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1175</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1176</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # 1) Writer: text paragraph.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1177</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1178</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # We need to handle two things here:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1179</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1180</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # If the old locus of focus was on the File-&gt;New-&gt;Text Document</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1181</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # menu item and we are currently have focus on an empty text</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1182</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # paragraph, then we've just created the first new text document</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1183</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # in Writer. Announce it by doing a "where am I".</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1184</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1185</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Also, when the focus is on a paragraph in the Document view of</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1186</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # the Writer, then just speak/braille the current line (rather than</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1187</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # speaking a bogus initial "paragraph" utterance as well).</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1188</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1189</td>
  <td class="nbHits">133</td>
  <td class="src"><pre>        rolesList = [rolenames.ROLE_PARAGRAPH, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1190</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_UNKNOWN, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1191</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_SCROLL_PANE, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1192</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_PANEL, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1193</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_ROOT_PANE, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1194</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_FRAME]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1195</td>
  <td class="nbHits">133</td>
  <td class="src"><pre>        if self.isDesiredFocusedItem(event.source, rolesList):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1196</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>            debug.println(self.debugLevel,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1197</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>                  "StarOffice.locusOfFocusChanged - Writer: text paragraph.")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1198</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1199</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>            result = self.getTextLineAtCaret(event.source)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1200</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>            result[0] = result[0].decode("UTF-8")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1201</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1202</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>            if oldLocusOfFocus.role == rolenames.ROLE_MENU_ITEM and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1203</td>
  <td class="nbHits"></td>
  <td class="src"><pre>               oldLocusOfFocus.name == _("Text Document") and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1204</td>
  <td class="nbHits"></td>
  <td class="src"><pre>               len(result[0]) == 0:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1205</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                self.whereAmI(None)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1206</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1207</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # Check to see if there are any hypertext links in this paragraph.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1208</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # If no, then just speak the whole line. Otherwise, split the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1209</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # line into words and call sayWriterWord() to speak that token</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1210</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # in the appropriate voice.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1211</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1212</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>            hypertext = event.source.hypertext</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1213</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>            if not hypertext or (hypertext.getNLinks() == 0):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1214</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>                if settings.enableSpeechIndentation:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1215</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    self.speakTextIndentation(event.source,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1216</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                              result[0].encode("UTF-8"))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1217</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>                speech.speak(result[0].encode("UTF-8"), None, False)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1218</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1219</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                started = False</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1220</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                startOffset = 0</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1221</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                for i in range(0, len(result[0])):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1222</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    if result[0][i] == ' ':</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1223</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        if started:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1224</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            endOffset = i</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1225</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            self.sayWriterWord(event.source,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1226</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                result[0][startOffset:endOffset+1].encode("UTF-8"),</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1227</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                startOffset, endOffset)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1228</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            startOffset = i</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1229</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            started = False</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1230</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                    else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1231</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        if not started:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1232</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            startOffset = i</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1233</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            started = True</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1234</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1235</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if started:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1236</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    endOffset = len(result[0])</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1237</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    self.sayWriterWord(event.source,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1238</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        result[0][startOffset:endOffset].encode("UTF-8"),</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1239</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        startOffset, endOffset)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1240</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1241</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>            braille.displayRegions(brailleGen.getBrailleRegions(event.source))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1242</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1243</td>
  <td class="nbHits">2</td>
  <td class="src"><pre>            return</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1244</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1245</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # 2) Writer: spell checking dialog.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1246</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1247</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Check to see if the Spell Check dialog has just appeared and got</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1248</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # focus. If it has, then speak/braille the current misspelt word</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1249</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # plus its context.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1250</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1251</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Note that in order to make sure that this focus event is for the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1252</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # spell check dialog, a check is made of the localized name of the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1253</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # option pane. Translators for other locales will need to ensure that</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1254</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # their translation of this string matches what StarOffice uses in</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1255</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # that locale.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1256</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1257</td>
  <td class="nbHits">131</td>
  <td class="src"><pre>        rolesList = [rolenames.ROLE_PUSH_BUTTON, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1258</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_OPTION_PANE, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1259</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_DIALOG, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1260</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_APPLICATION]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1261</td>
  <td class="nbHits">131</td>
  <td class="src"><pre>        if self.isDesiredFocusedItem(event.source, rolesList):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1262</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            pane = event.source.parent</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1263</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if pane.name.startswith(_("Spellcheck:")):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1264</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                debug.println(self.debugLevel,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1265</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    "StarOffice.locusOfFocusChanged - " \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1266</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                    + "Writer: spell check dialog.")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1267</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1268</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                self.readMisspeltWord(event, pane)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1269</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1270</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                # Fall-thru to process the event with the default handler.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1271</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1272</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # 3) Welcome to StarOffice dialog.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1273</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1274</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Check to see if the object that just got focus is in the Setup</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1275</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # dialog. If it is, then check for a variety of scenerios.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1276</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1277</td>
  <td class="nbHits">131</td>
  <td class="src"><pre>        if self.isSetupDialog(event.source):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1278</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1279</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # Check for 2. License Agreement: Scroll Down button.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1280</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1281</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            rolesList = [rolenames.ROLE_PUSH_BUTTON, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1282</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                         rolenames.ROLE_PANEL, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1283</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                         rolenames.ROLE_OPTION_PANE, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1284</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                         rolenames.ROLE_DIALOG, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1285</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                         rolenames.ROLE_APPLICATION]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1286</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if self.isDesiredFocusedItem(event.source, rolesList):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1287</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                debug.println(self.debugLevel,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1288</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    "StarOffice.locusOfFocusChanged - Setup dialog: " \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1289</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                    + "License Agreement screen: Scroll Down button.")</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1290</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                self.handleSetupPanel(event.source.parent)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1291</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                speech.speak(_("Note that the Scroll Down button has to be pressed numerous times."))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1292</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1293</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # Check for 2. License Agreement: Accept button.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1294</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1295</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            rolesList = [rolenames.ROLE_UNKNOWN, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1296</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                         rolenames.ROLE_SCROLL_PANE, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1297</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                         rolenames.ROLE_PANEL, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1298</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                         rolenames.ROLE_OPTION_PANE, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1299</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                         rolenames.ROLE_DIALOG, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1300</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                         rolenames.ROLE_APPLICATION]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1301</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if self.isDesiredFocusedItem(event.source, rolesList):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1302</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                debug.println(self.debugLevel,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1303</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    "StarOffice.locusOfFocusChanged - Setup dialog: " \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1304</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                    + "License Agreement screen: accept button.")</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1305</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                speech.speak(_("License Agreement Accept button now has focus."))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1306</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1307</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # Check for 3. Personal Data: Transfer Personal Data check box.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1308</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1309</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            rolesList = [rolenames.ROLE_CHECK_BOX, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1310</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                         rolenames.ROLE_PANEL, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1311</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                         rolenames.ROLE_OPTION_PANE, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1312</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                         rolenames.ROLE_DIALOG, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1313</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                         rolenames.ROLE_APPLICATION]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1314</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if self.isDesiredFocusedItem(event.source, rolesList):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1315</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                debug.println(self.debugLevel,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1316</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    "StarOffice.locusOfFocusChanged - Setup dialog: " \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1317</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                    + "Personal Data: Transfer Personal Data check box.")</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1318</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                self.handleSetupPanel(event.source.parent)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1319</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1320</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # Check for 4. User name: First Name text field.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1321</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1322</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            rolesList = [rolenames.ROLE_TEXT, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1323</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                        rolenames.ROLE_PANEL, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1324</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                        rolenames.ROLE_OPTION_PANE, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1325</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                        rolenames.ROLE_DIALOG, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1326</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                        rolenames.ROLE_APPLICATION]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1327</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if self.isDesiredFocusedItem(event.source, rolesList) and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1328</td>
  <td class="nbHits"></td>
  <td class="src"><pre>               event.source.name == _("First name"):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1329</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                debug.println(self.debugLevel,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1330</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    "StarOffice.locusOfFocusChanged - Setup dialog: " \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1331</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                    + "User name: First Name text field.")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1332</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1333</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                # Just speak the informative labels at the top of the panel</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1334</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                # (and not the ones that have LABEL_FOR relationships).</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1335</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1336</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                panel = event.source.parent</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1337</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                allLabels = self.findByRole(panel, rolenames.ROLE_LABEL)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1338</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                for i in range(0, len(allLabels)):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1339</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    relations = allLabels[i].relations</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1340</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    hasLabelFor = False</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1341</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    for relation in relations:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1342</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        if relation.getRelationType() \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1343</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                               == atspi.Accessibility.RELATION_LABEL_FOR:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1344</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            hasLabelFor = True</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1345</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    if not hasLabelFor:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1346</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        self.speakSetupLabel(allLabels[i])</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1347</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1348</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # Check for 5. Registration: Register Now radio button.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1349</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1350</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            rolesList = [rolenames.ROLE_RADIO_BUTTON, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1351</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                        rolenames.ROLE_PANEL, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1352</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                        rolenames.ROLE_OPTION_PANE, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1353</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                        rolenames.ROLE_DIALOG, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1354</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                        rolenames.ROLE_APPLICATION]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1355</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if self.isDesiredFocusedItem(event.source, rolesList):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1356</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                debug.println(self.debugLevel,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1357</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    "StarOffice.locusOfFocusChanged - Setup dialog: " \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1358</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                    + "Registration: Register Now radio button.")</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1359</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                self.handleSetupPanel(event.source.parent)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1360</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1361</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # 4) Calc: cell editor.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1362</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1363</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Check to see if we are editing a spread sheet cell. If so, just</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1364</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # return to avoid uttering something like "Paragraph 0 paragraph".</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1365</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1366</td>
  <td class="nbHits">131</td>
  <td class="src"><pre>        rolesList = [rolenames.ROLE_PARAGRAPH, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1367</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_PANEL, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1368</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_UNKNOWN, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1369</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_SCROLL_PANE, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1370</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_PANEL, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1371</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_ROOT_PANE, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1372</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_FRAME, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1373</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_APPLICATION]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1374</td>
  <td class="nbHits">131</td>
  <td class="src"><pre>        if self.isDesiredFocusedItem(event.source, rolesList):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1375</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            debug.println(self.debugLevel, "StarOffice.locusOfFocusChanged - " \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1376</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                          + "Calc: cell editor.")</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1377</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1378</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1379</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # 5) Calc: name box</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1380</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1381</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Check to see if the focus has just moved to the Name Box combo</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1382</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # box in Calc. If so, then replace the non-existent name with a</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1383</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # simple one before falling through and calling the default </pre></td>
</tr>
<tr class="">
  <td class="nbLine">1384</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # locusOfFocusChanged method, which in turn will result in our</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1385</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # _getSpeechForComboBox() method being called.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1386</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1387</td>
  <td class="nbHits">131</td>
  <td class="src"><pre>        rolesList = [rolenames.ROLE_COMBO_BOX, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1388</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_TOOL_BAR, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1389</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_PANEL, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1390</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_ROOT_PANE, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1391</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_FRAME, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1392</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_APPLICATION]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1393</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1394</td>
  <td class="nbHits">131</td>
  <td class="src"><pre>        if self.isDesiredFocusedItem(event.source, rolesList) \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1395</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            and (not event.source.name or len(event.source.name) == 0):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1396</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            debug.println(self.debugLevel, "StarOffice.locusOfFocusChanged - " \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1397</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                          + "Calc: name box.")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1398</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1399</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            event.source.name = _("Move to cell")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1400</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1401</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Pass the event onto the parent class to be handled in the default way.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1402</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1403</td>
  <td class="nbHits">131</td>
  <td class="src"><pre>        default.Script.locusOfFocusChanged(self, event,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1404</td>
  <td class="nbHits">131</td>
  <td class="src"><pre>                                           oldLocusOfFocus, newLocusOfFocus)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1405</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1406</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    # This method tries to detect and handle the following cases:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1407</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    # 1) Setup dialog.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1408</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1409</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def onWindowActivated(self, event):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1410</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Called whenever a property on an object changes.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1411</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1412</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1413</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - event: the Event</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1414</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1415</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1416</td>
  <td class="nbHits">7</td>
  <td class="src"><pre>        debug.printObjectEvent(self.debugLevel,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1417</td>
  <td class="nbHits">7</td>
  <td class="src"><pre>                               event,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1418</td>
  <td class="nbHits">7</td>
  <td class="src"><pre>                               event.source.toString())</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1419</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1420</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # self.printAncestry(event.source)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1421</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1422</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # 1) Setup dialog.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1423</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1424</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Check to see if the Setup dialog window has just been activated.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1425</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # If it has, then find the panel within it that has no name and</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1426</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # speak all the labels within that panel.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1427</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1428</td>
  <td class="nbHits">7</td>
  <td class="src"><pre>        if self.isSetupDialog(event.source):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1429</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            debug.println(self.debugLevel,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1430</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                "StarOffice.onWindowActivated - Setup dialog: Welcome screen.")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1431</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1432</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            allPanels = self.findByRole(event.source.parent,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1433</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                        rolenames.ROLE_PANEL)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1434</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            for i in range(0, len(allPanels)):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1435</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if not allPanels[i].name:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1436</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    allLabels = self.findByRole(allPanels[i],</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1437</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                                rolenames.ROLE_LABEL)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1438</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    for i in range(0, len(allLabels)):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1439</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        self.speakSetupLabel(allLabels[i])</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1440</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        else:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1441</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # Pass the event onto the parent class to be handled in the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1442</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # default way.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1443</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1444</td>
  <td class="nbHits">7</td>
  <td class="src"><pre>            default.Script.onWindowActivated(self, event)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1445</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1446</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1447</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    # This method tries to detect and handle the following cases:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1448</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    # 1) Writer: spell checking dialog.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1449</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1450</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def onNameChanged(self, event):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1451</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Called whenever a property on an object changes.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1452</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1453</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1454</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - event: the Event</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1455</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1456</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1457</td>
  <td class="nbHits">42</td>
  <td class="src"><pre>        brailleGen = self.brailleGenerator</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1458</td>
  <td class="nbHits">42</td>
  <td class="src"><pre>        speechGen = self.speechGenerator</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1459</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1460</td>
  <td class="nbHits">42</td>
  <td class="src"><pre>        debug.printObjectEvent(self.debugLevel,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1461</td>
  <td class="nbHits">42</td>
  <td class="src"><pre>                               event,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1462</td>
  <td class="nbHits">42</td>
  <td class="src"><pre>                               event.source.toString())</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1463</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1464</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # self.printAncestry(event.source)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1465</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1466</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # 1) Writer: spell checking dialog.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1467</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1468</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Check to see if if we've had a property-change event for the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1469</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # accessible name for the option pane in the spell check dialog.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1470</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # This (hopefully) means that the user has just corrected a</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1471</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # spelling mistake, in which case, speak/braille the current</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1472</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # misspelt word plus its context.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1473</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1474</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Note that in order to make sure that this focus event is for the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1475</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # spell check dialog, a check is made of the localized name of the</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1476</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # option pane. Translators for other locales will need to ensure that</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1477</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # their translation of this string matches what StarOffice uses in</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1478</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # that locale.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1479</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1480</td>
  <td class="nbHits">42</td>
  <td class="src"><pre>        rolesList = [rolenames.ROLE_OPTION_PANE, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1481</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_DIALOG, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1482</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_APPLICATION]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1483</td>
  <td class="nbHits">42</td>
  <td class="src"><pre>        if self.isDesiredFocusedItem(event.source, rolesList):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1484</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            pane = event.source</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1485</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if pane.name.startswith(_("Spellcheck:")):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1486</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                debug.println(self.debugLevel,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1487</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                      "StarOffice.onNameChanged - Writer: spell check dialog.")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1488</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1489</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                self.readMisspeltWord(event, pane)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1490</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1491</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                # Fall-thru to process the event with the default handler.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1492</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1493</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Pass the event onto the parent class to be handled in the default way.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1494</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1495</td>
  <td class="nbHits">42</td>
  <td class="src"><pre>        default.Script.onNameChanged(self, event)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1496</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1497</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1498</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def onFocus(self, event):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1499</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Called whenever an object gets focus. Overridden in this script </pre></td>
</tr>
<tr class="">
  <td class="nbLine">1500</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        so that we can adjust "focus:" events for children of a combo-box </pre></td>
</tr>
<tr class="">
  <td class="nbLine">1501</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        to just set the focus to the combo box. This is needed to help </pre></td>
</tr>
<tr class="">
  <td class="nbLine">1502</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        reduce the verbosity of focusing on the Calc Name combo box (see </pre></td>
</tr>
<tr class="">
  <td class="nbLine">1503</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        bug #364407).</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1504</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1505</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1506</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - event: the Event</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1507</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1508</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1509</td>
  <td class="nbHits">155</td>
  <td class="src"><pre>        if event.source.parent.role == rolenames.ROLE_COMBO_BOX:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1510</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            orca.setLocusOfFocus(None, event.source.parent, False)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1511</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1512</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1513</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # If we are FOCUSED on a paragraph inside a table cell (in Writer),</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1514</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # then speak/braille that parent table cell (see bug #382415).</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1515</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1516</td>
  <td class="nbHits">155</td>
  <td class="src"><pre>        if event.source.role == rolenames.ROLE_PARAGRAPH and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1517</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           event.source.parent.role == rolenames.ROLE_TABLE_CELL and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1518</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           event.source.state.count(atspi.Accessibility.STATE_FOCUSED):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1519</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if self.lastCell != event.source.parent:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1520</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                default.Script.locusOfFocusChanged(self, event,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1521</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                                   None, event.source.parent)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1522</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                self.lastCell = event.source.parent</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1523</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1524</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1525</td>
  <td class="nbHits">155</td>
  <td class="src"><pre>        default.Script.onFocus(self, event)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1526</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1527</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def onStateChanged(self, event):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1528</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Called whenever an object's state changes.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1529</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1530</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1531</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - event: the Event</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1532</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1533</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1534</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # If this is a state change "focused" event that we care about, and </pre></td>
</tr>
<tr class="">
  <td class="nbLine">1535</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # we are in Writer, check to see if we are entering or leaving a table.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1536</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1537</td>
  <td class="nbHits">563</td>
  <td class="src"><pre>        if event.type == "object:state-changed:focused" and event.detail1 == 1:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1538</td>
  <td class="nbHits">63</td>
  <td class="src"><pre>            current = event.source.parent</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1539</td>
  <td class="nbHits">317</td>
  <td class="src"><pre>            while current.role != rolenames.ROLE_APPLICATION:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1540</td>
  <td class="nbHits">301</td>
  <td class="src"><pre>                if current.role == rolenames.ROLE_FRAME and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1541</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                   (current.name and current.name.endswith(_("Writer"))):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1542</td>
  <td class="nbHits">47</td>
  <td class="src"><pre>                    self.checkForTableBoundry(orca_state.locusOfFocus, </pre></td>
</tr>
<tr class="">
  <td class="nbLine">1543</td>
  <td class="nbHits">47</td>
  <td class="src"><pre>                                              event.source)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1544</td>
  <td class="nbHits">47</td>
  <td class="src"><pre>                    break</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1545</td>
  <td class="nbHits">254</td>
  <td class="src"><pre>                current = current.parent</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1546</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1547</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Prevent  "object:state-changed:active" events from activating</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1548</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # the find operation. See comment #18 of bug #354463.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1549</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1550</td>
  <td class="nbHits">551</td>
  <td class="src"><pre>        if event.type == "object:state-changed:active":</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1551</td>
  <td class="nbHits">23</td>
  <td class="src"><pre>            if self.findCommandRun:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1552</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                return</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1553</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1554</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # [[[TODO: JD - HACK because we won't get events from toggle</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1555</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # buttons on the Formatting toolbar until we "tickle/poke"</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1556</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # the hierarchy. But we only want to do it once.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1557</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # See bug #363830 and OOo issue #70872.]]]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1558</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1559</td>
  <td class="nbHits">23</td>
  <td class="src"><pre>            if not self.tickled:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1560</td>
  <td class="nbHits">4</td>
  <td class="src"><pre>                self.tickled = self.flatReviewContextClass(self)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1561</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1562</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Announce when the toolbar buttons are toggled if we just toggled</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1563</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # them; not if we navigated to some text.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1564</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1565</td>
  <td class="nbHits">551</td>
  <td class="src"><pre>        if event.type == "object:state-changed:checked" and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1566</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           (event.source.role == rolenames.ROLE_TOGGLE_BUTTON or \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1567</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            event.source.role == rolenames.ROLE_PUSH_BUTTON):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1568</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            weToggledIt = False</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1569</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if isinstance(orca_state.lastInputEvent, \</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1570</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                          input_event.MouseButtonEvent):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1571</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                x = orca_state.lastInputEvent.x</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1572</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                y = orca_state.lastInputEvent.y</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1573</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                weToggledIt = event.source.component.contains(x, y, 0)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1574</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1575</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            elif isinstance(orca_state.lastInputEvent, input_event.KeyboardEvent):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1576</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                keyString = orca_state.lastInputEvent.event_string  </pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1577</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                navKeys = ["Up", "Down", "Page_Up", "Page_Down", "Home", "End"]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1578</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                wasCommand = orca_state.lastInputEvent.modifiers \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1579</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                             &amp; (1 &lt;&lt; atspi.Accessibility.MODIFIER_CONTROL \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1580</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                              | 1 &lt;&lt; atspi.Accessibility.MODIFIER_ALT \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1581</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                              | 1 &lt;&lt; atspi.Accessibility.MODIFIER_META \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1582</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                              | 1 &lt;&lt; atspi.Accessibility.MODIFIER_META2 \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1583</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                              | 1 &lt;&lt; atspi.Accessibility.MODIFIER_META3)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1584</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                weToggledIt = wasCommand and keyString not in navKeys</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1585</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1586</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if weToggledIt:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1587</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                speech.speakUtterances(self.speechGenerator.getSpeech( \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1588</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                                       event.source, False))</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1589</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1590</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # If we are FOCUSED on a paragraph inside a table cell (in Writer),</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1591</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # then speak/braille that parent table cell (see bug #382415).</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1592</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1593</td>
  <td class="nbHits">551</td>
  <td class="src"><pre>        if event.type == "object:state-changed:focused" and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1594</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           event.source.role == rolenames.ROLE_PARAGRAPH and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1595</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           event.source.parent.role == rolenames.ROLE_TABLE_CELL and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1596</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           event.detail1 == 0 and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1597</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           event.source.state.count(atspi.Accessibility.STATE_FOCUSED):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1598</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1599</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # Check to see if the last input event was "Up" or "Down".</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1600</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # If it was, and we are in the same table cell as last time,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1601</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # and if that table cell has more than one child, then just</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1602</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # get the speech for that single child, otherwise speak/braille</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1603</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # the parent table cell.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1604</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1605</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            event_string = None</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1606</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if isinstance(orca_state.lastInputEvent, input_event.KeyboardEvent):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1607</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                event_string = orca_state.lastInputEvent.event_string</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1608</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if (event_string == "Up" or event_string == "Down") and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1609</td>
  <td class="nbHits"></td>
  <td class="src"><pre>               event.source.parent == self.lastCell and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1610</td>
  <td class="nbHits"></td>
  <td class="src"><pre>               event.source.parent.childCount &gt; 1:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1611</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                default.Script.locusOfFocusChanged(self, event,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1612</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                                   None, event.source)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1613</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            else:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1614</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                default.Script.locusOfFocusChanged(self, event,</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1615</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                                   None, event.source.parent)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1616</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            self.lastCell = event.source.parent</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1617</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1618</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1619</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Two events are received when the caret moves</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1620</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # to a new paragraph. The first is a focus event</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1621</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # (in the form of object:state-changed:focused</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1622</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # instead of focus:). The second is a caret-moved</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1623</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # event. Just set the locusOfFocus for the first event.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1624</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # </pre></td>
</tr>
<tr class="">
  <td class="nbLine">1625</td>
  <td class="nbHits">551</td>
  <td class="src"><pre>        if event.type == "object:state-changed:focused" and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1626</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           event.source.role == rolenames.ROLE_PARAGRAPH and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1627</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           event.source != self.currentParagraph:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1628</td>
  <td class="nbHits">38</td>
  <td class="src"><pre>            self.currentParagraph = event.source</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1629</td>
  <td class="nbHits">38</td>
  <td class="src"><pre>            orca.setLocusOfFocus(event, event.source, False)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1630</td>
  <td class="nbHits">38</td>
  <td class="src"><pre>            return</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1631</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1632</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # If we get "object:state-changed:focused" events for children of </pre></td>
</tr>
<tr class="">
  <td class="nbLine">1633</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # a combo-box, just set the focus to the combo box. This is needed </pre></td>
</tr>
<tr class="">
  <td class="nbLine">1634</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # to help reduce the verbosity of focusing on the Calc Name combo </pre></td>
</tr>
<tr class="">
  <td class="nbLine">1635</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # box (see bug #364407).</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1636</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1637</td>
  <td class="nbHits">513</td>
  <td class="src"><pre>        if event.source.parent and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1638</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           event.source.parent.role == rolenames.ROLE_COMBO_BOX:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1639</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>            orca.setLocusOfFocus(None, event.source.parent, False)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1640</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>            return</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1641</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1642</td>
  <td class="nbHits">512</td>
  <td class="src"><pre>        default.Script.onStateChanged(self, event)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1643</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1644</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1645</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    # This method tries to detect and handle the following cases:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1646</td>
  <td class="nbHits"></td>
  <td class="src"><pre>    # 1) Calc: spread sheet Name Box line.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1647</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1648</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def onSelectionChanged(self, event):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1649</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Called when an object's selection changes.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1650</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1651</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1652</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - event: the Event</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1653</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1654</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1655</td>
  <td class="nbHits">33</td>
  <td class="src"><pre>        debug.printObjectEvent(self.debugLevel,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1656</td>
  <td class="nbHits">33</td>
  <td class="src"><pre>                               event,</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1657</td>
  <td class="nbHits">33</td>
  <td class="src"><pre>                               event.source.toString())</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1658</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1659</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # self.printAncestry(event.source)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1660</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1661</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # 1) Calc: spread sheet input line.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1662</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1663</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # If this "object:selection-changed" is for the spread sheet Name</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1664</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Box, then check to see if the current locus of focus is a spread</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1665</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # sheet cell. If it is, and the contents of the input line are</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1666</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # different from what is displayed in that cell, then speak "has</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1667</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # formula" and append it to the braille line.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1668</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1669</td>
  <td class="nbHits">33</td>
  <td class="src"><pre>        rolesList = [rolenames.ROLE_LIST, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1670</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_COMBO_BOX, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1671</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_PANEL, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1672</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_TOOL_BAR, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1673</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_PANEL, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1674</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_ROOT_PANE, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1675</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_FRAME, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1676</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                     rolenames.ROLE_APPLICATION]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1677</td>
  <td class="nbHits">33</td>
  <td class="src"><pre>        if self.isDesiredFocusedItem(event.source, rolesList):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1678</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if orca_state.locusOfFocus.role == rolenames.ROLE_TABLE_CELL:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1679</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                cell = orca_state.locusOfFocus</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1680</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1681</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                # We are getting two "object:selection-changed" events</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1682</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                # for each spread sheet cell move, so in order to prevent</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1683</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                # appending "has formula" twice, we only do it if the last</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1684</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                # cell is different from this one.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1685</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1686</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if cell != self.lastCell:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1687</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    self.lastCell = cell</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1688</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1689</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    if cell.text:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1690</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        cellText = self.getText(cell, 0, -1)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1691</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        if cellText and len(cellText):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1692</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                            if inputLineForCell and inputLineForCell.text:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1693</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                inputLine = self.getText(inputLineForCell,0,-1)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1694</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                if inputLine and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1695</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                                    (len(inputLine) &gt; 1) and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1696</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                                    (inputLine[0] == "="):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1697</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                        hf = _(" has formula")</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1698</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                        speech.speak(hf, None, False)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1699</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1700</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                        line = braille.getShowingLine()</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1701</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                        line.addRegion(braille.Region(hf))</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1702</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                                        braille.refresh()</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1703</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                                        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1704</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                                        # Fall-thru to process the event with</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1705</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                                        # the default handler.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1706</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1707</td>
  <td class="nbHits">33</td>
  <td class="src"><pre>        default.Script.onSelectionChanged(self, event)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1708</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1709</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def getText(self, obj, startOffset, endOffset):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1710</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Returns the substring of the given object's text specialization.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1711</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1712</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        NOTE: This is here to handle the problematic implementation of</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1713</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        getText by OpenOffice.  See the bug discussion at:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1714</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1715</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           http://bugzilla.gnome.org/show_bug.cgi?id=356425)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1716</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1717</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Once the OpenOffice issue has been resolved, this method probably</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1718</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        should be removed.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1719</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1720</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1721</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - obj: an accessible supporting the accessible text specialization</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1722</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - startOffset: the starting character position</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1723</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - endOffset: the ending character position</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1724</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1725</td>
  <td class="nbHits">59</td>
  <td class="src"><pre>        text = obj.text.getText(0, -1).decode("UTF-8")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1726</td>
  <td class="nbHits">59</td>
  <td class="src"><pre>        if startOffset &gt;= len(text):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1727</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            startOffset = len(text) - 1</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1728</td>
  <td class="nbHits">59</td>
  <td class="src"><pre>        if endOffset == -1:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1729</td>
  <td class="nbHits">12</td>
  <td class="src"><pre>            endOffset = len(text)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1730</td>
  <td class="nbHits">47</td>
  <td class="src"><pre>        elif startOffset &gt;= endOffset:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1731</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            endOffset = startOffset + 1</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1732</td>
  <td class="nbHits">59</td>
  <td class="src"><pre>        string = text[max(0,startOffset):min(len(text),endOffset)]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1733</td>
  <td class="nbHits">59</td>
  <td class="src"><pre>        string = string.encode("UTF-8")</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1734</td>
  <td class="nbHits">59</td>
  <td class="src"><pre>        return string</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1735</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1736</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def speakCellName(self, name):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1737</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Speaks the given cell name.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1738</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1739</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1740</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - name: the name of the cell</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1741</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1742</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1743</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        line = _("Cell ") + name</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1744</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>        speech.speak(line)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1745</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1746</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def onCaretMoved(self, event):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1747</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Called whenever the caret moves.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1748</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1749</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Arguments:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1750</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        - event: the Event</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1751</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1752</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1753</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # If we are FOCUSED on a paragraph inside a table cell (in Writer),</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1754</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # then just return (modulo the special cases below). Speaking and </pre></td>
</tr>
<tr class="">
  <td class="nbLine">1755</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # brailling will have been done in the onStateChanged() routine </pre></td>
</tr>
<tr class="">
  <td class="nbLine">1756</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # (see bug #382415).</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1757</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        #</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1758</td>
  <td class="nbHits">196</td>
  <td class="src"><pre>        if event.source.role == rolenames.ROLE_PARAGRAPH and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1759</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           event.source.parent.role == rolenames.ROLE_TABLE_CELL and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1760</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           event.source.state.count(atspi.Accessibility.STATE_FOCUSED):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1761</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            event_string = orca_state.lastInputEvent.event_string</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1762</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1763</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # If we are moving up and down, and we are speaking-by-cell</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1764</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # (as opposed to by-row), then speak the cell name. Otherwise</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1765</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # just return.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1766</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1767</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if (event_string == "Up" or event_string == "Down"):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1768</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if settings.readTableCellRow == False:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1769</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    if event.detail1 != -1:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1770</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        self.speakCellName(event.source.parent.name)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1771</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                return</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1772</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1773</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # If we are moving left or right and we are in a new cell, just</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1774</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # return.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1775</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1776</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if (event_string == "Left" or event_string == "Right") and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1777</td>
  <td class="nbHits"></td>
  <td class="src"><pre>               self.lastCell != event.source.parent:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1778</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                return</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1779</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1780</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            caretOffset = event.source.text.caretOffset</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1781</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            len = event.source.text.characterCount</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1782</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1783</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # If you are in a table cell and you arrow Right, the caret </pre></td>
</tr>
<tr class="">
  <td class="nbLine">1784</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # will focus at the end of the current paragraph before moving </pre></td>
</tr>
<tr class="">
  <td class="nbLine">1785</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # into the next cell. To be similar to the way that caret </pre></td>
</tr>
<tr class="">
  <td class="nbLine">1786</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # navigation works in other paragraphs in OOo, just return.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1787</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1788</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if event_string == "Right" and caretOffset == len:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1789</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                return</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1790</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1791</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # If we have moved left and the caret position is at the end of</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1792</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # the paragraph or if we have moved right and the caret position</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1793</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # is at the start of the text string, or the last key input was</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1794</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # Tab or Shift-Tab, and if we are speaking-by-cell (as opposed </pre></td>
</tr>
<tr class="">
  <td class="nbLine">1795</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # to by-row), then speak the cell name, otherwise just return </pre></td>
</tr>
<tr class="">
  <td class="nbLine">1796</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # (see bug #382418).</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1797</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            #</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1798</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if (event_string == "Left" and caretOffset == len) or \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1799</td>
  <td class="nbHits"></td>
  <td class="src"><pre>               (event_string == "Right" and caretOffset == 0) or \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1800</td>
  <td class="nbHits"></td>
  <td class="src"><pre>               (event_string == "Tab" or event_string == "ISO_Left_Tab"):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1801</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if settings.readTableCellRow == False:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1802</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    if event.detail1 != -1:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1803</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                        self.speakCellName(event.source.parent.name)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1804</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1805</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                # Speak a blank line, if appropriate.</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1806</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if self.speakBlankLine(event.source):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1807</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    speech.speak(_("blank"), None, False)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1808</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                return</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1809</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1810</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Speak a newline, if appropriate.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1811</td>
  <td class="nbHits">196</td>
  <td class="src"><pre>        if self.speakNewLine(event.source):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1812</td>
  <td class="nbHits">12</td>
  <td class="src"><pre>            speech.speak(chnames.getCharacterName("\n"), None, False)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1813</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1814</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Speak a blank line, if appropriate.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1815</td>
  <td class="nbHits">196</td>
  <td class="src"><pre>        if self.speakBlankLine(event.source):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1816</td>
  <td class="nbHits">10</td>
  <td class="src"><pre>            speech.speak(_("blank"), None, False)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1817</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1818</td>
  <td class="nbHits">196</td>
  <td class="src"><pre>        default.Script.onCaretMoved(self, event)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1819</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1820</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1821</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def speakNewLine(self, obj):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1822</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Returns True if a newline should be spoken.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1823</td>
  <td class="nbHits"></td>
  <td class="src"><pre>           Otherwise, returns False.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1824</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1825</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1826</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Get the the AccessibleText interrface.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1827</td>
  <td class="nbHits">196</td>
  <td class="src"><pre>        text = obj.text</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1828</td>
  <td class="nbHits">196</td>
  <td class="src"><pre>        if not text:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1829</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return False</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1830</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1831</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Was a left or right-arrow key pressed?</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1832</td>
  <td class="nbHits">196</td>
  <td class="src"><pre>        if not (orca_state.lastInputEvent and \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1833</td>
  <td class="nbHits"></td>
  <td class="src"><pre>                orca_state.lastInputEvent.__dict__.has_key("event_string")):</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1834</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return False</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1835</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1836</td>
  <td class="nbHits">196</td>
  <td class="src"><pre>        lastKey = orca_state.lastInputEvent.event_string</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1837</td>
  <td class="nbHits">196</td>
  <td class="src"><pre>        if lastKey != "Left" and lastKey != "Right":</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1838</td>
  <td class="nbHits">160</td>
  <td class="src"><pre>            return False</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1839</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1840</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Was a control key pressed?</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1841</td>
  <td class="nbHits">36</td>
  <td class="src"><pre>        mods = orca_state.lastInputEvent.modifiers</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1842</td>
  <td class="nbHits">36</td>
  <td class="src"><pre>        isControlKey = mods &amp; (1 &lt;&lt; atspi.Accessibility.MODIFIER_CONTROL)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1843</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1844</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Get the line containing the caret</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1845</td>
  <td class="nbHits">36</td>
  <td class="src"><pre>        caretOffset = text.caretOffset</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1846</td>
  <td class="nbHits">36</td>
  <td class="src"><pre>        line = text.getTextAtOffset(caretOffset, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1847</td>
  <td class="nbHits">36</td>
  <td class="src"><pre>            atspi.Accessibility.TEXT_BOUNDARY_LINE_START)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1848</td>
  <td class="nbHits">36</td>
  <td class="src"><pre>        lineStart = line[1]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1849</td>
  <td class="nbHits">36</td>
  <td class="src"><pre>        lineEnd = line[2]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1850</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1851</td>
  <td class="nbHits">36</td>
  <td class="src"><pre>        if isControlKey:  # control-right-arrow or control-left-arrow</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1852</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1853</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            # Get the word containing the caret.</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1854</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            word = text.getTextAtOffset(caretOffset, \</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1855</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                atspi.Accessibility.TEXT_BOUNDARY_WORD_START)</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1856</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            wordStart = word[1]</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1857</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            wordEnd = word[2]</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1858</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1859</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            if lastKey == "Right":</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1860</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if wordStart == lineStart:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1861</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    return True</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1862</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            else: </pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1863</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                if wordEnd == lineEnd:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1864</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>                    return True</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1865</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1866</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        else:  # right arrow or left arrow</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1867</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1868</td>
  <td class="nbHits">36</td>
  <td class="src"><pre>            if lastKey == "Right":</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1869</td>
  <td class="nbHits">18</td>
  <td class="src"><pre>                if caretOffset == lineStart:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1870</td>
  <td class="nbHits">6</td>
  <td class="src"><pre>                    return True</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1871</td>
  <td class="nbHits"></td>
  <td class="src"><pre>            else: </pre></td>
</tr>
<tr class="">
  <td class="nbLine">1872</td>
  <td class="nbHits">18</td>
  <td class="src"><pre>                if caretOffset == lineEnd:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1873</td>
  <td class="nbHits">6</td>
  <td class="src"><pre>                    return True</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1874</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1875</td>
  <td class="nbHits">24</td>
  <td class="src"><pre>        return False</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1876</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1877</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1878</td>
  <td class="nbHits">1</td>
  <td class="src"><pre>    def speakBlankLine(self, obj):</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1879</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """Returns True if a blank line should be spoken.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1880</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        Otherwise, returns False.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1881</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        """</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1882</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1883</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Get the the AccessibleText interrface. </pre></td>
</tr>
<tr class="">
  <td class="nbLine">1884</td>
  <td class="nbHits">196</td>
  <td class="src"><pre>        text = obj.text</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1885</td>
  <td class="nbHits">196</td>
  <td class="src"><pre>        if not text:</pre></td>
</tr>
<tr class="uncovered">
  <td class="nbLine">1886</td>
  <td class="nbHits">0</td>
  <td class="src"><pre>            return False</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1887</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1888</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # Get the line containing the caret</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1889</td>
  <td class="nbHits">196</td>
  <td class="src"><pre>        caretOffset = text.caretOffset</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1890</td>
  <td class="nbHits">196</td>
  <td class="src"><pre>        line = text.getTextAtOffset(caretOffset, \</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1891</td>
  <td class="nbHits">196</td>
  <td class="src"><pre>            atspi.Accessibility.TEXT_BOUNDARY_LINE_START)</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1892</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>
<tr class="">
  <td class="nbLine">1893</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # If this is a blank line, announce it if the user requested</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1894</td>
  <td class="nbHits"></td>
  <td class="src"><pre>        # that blank lines be spoken.</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1895</td>
  <td class="nbHits">196</td>
  <td class="src"><pre>        if line[1] == 0 and line[2] == 0:</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1896</td>
  <td class="nbHits">10</td>
  <td class="src"><pre>            return settings.speakBlankLines</pre></td>
</tr>
<tr class="">
  <td class="nbLine">1897</td>
  <td class="nbHits"></td>
  <td class="src"></td>
</tr>

</tbody>
</table>


<p class="footer">
Report generated by <a href="http://cheeseshop.python.org/pypi/trace2html"
>trace2html</a> on 2007-03-07 09:42:32.253581.
</p>

</body>

</html>
